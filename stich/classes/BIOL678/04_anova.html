<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">danStich</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../../index.html">Home</a>
</li>
<li>
  <a href="../../teaching.html">Teaching</a>
</li>
<li>
  <a href="../../research.html">Research</a>
</li>
<li>
  <a href="../../cv.html">Curriculum vitae</a>
</li>
<li>
  <a href="../../courseWebsites.html">Course websites</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}

.column {
    float: left;
    padding: 15px;
}

.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

.content {
    width: 75%;
}

</style>
<p><br></p>
<div id="anova-worked-example" class="section level1">
<h1>ANOVA worked example</h1>
<p><br></p>
<p>The purpose of this tutorial is to give a brief, <em>coherent</em> introduction to analysis of variance (ANOVA) and give you a worked example that you can use as a template for future analyses.</p>
<p><br></p>
<div id="why-do-we-use-it" class="section level2">
<h2>Why do we use it?</h2>
<p><br></p>
<p>Last week we talked about how to compare the means of two groups to determine whether or not the sample distributions came from the same statistical population. But what do we do if we want to compare three groups?? ANOVA.</p>
<p>We use ANOVA when we would like to test the effect of one or more grouping variables on a continuous response. We generally tend to reserve ANOVA for those cases in which the grouping variable has more than two levels. To clarify, if we wished to test differences in the response between only two groups (e.g. male and female) then we would use a t-test or a Wilcoxon rank-sum test. If we wished to extend that to include three or more groups (e.g., treatment 1, treatment 2, and control) we would use an ANOVA or a non-parametric alternative.</p>
<p><br></p>
</div>
<div id="how-do-we-do-it" class="section level2">
<h2>How do we do it?</h2>
<p><br></p>
<div id="syntax" class="section level3">
<h3>Syntax</h3>
<p><br></p>
<p>In R, ANOVA and all other linear models that we will discuss this week are fit using the <code>lm</code> function. Let’s have a look:</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(lm)
## function (formula, data, subset, weights, na.action, method = &quot;qr&quot;, 
##     model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, 
##     contrasts = NULL, offset, ...)</code></pre></div>
<p><br></p>
<p>This shows us that <code>lm</code> is a function. It takes a number of arguments, but the ones that will concern us in this course are <code>formula</code> and <code>data</code>. The <code>formula</code> argument needs to be specified as a mathematical formula, and takes the following form:</p>
<p><span class="math inline">\(y \sim x_1 + x_2, ..., + x_k\)</span></p>
<p>where <span class="math inline">\(y\)</span> is the name of our response variable, and each <span class="math inline">\(x\)</span> is the name of an explanatory variable that we wish to include in our example.</p>
<p>The <code>data</code> argument is optional, but is usually a dataframe that holds our data.</p>
<p><br></p>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<p><br></p>
<p>Let’s walk through a quick example of what this looks like using the PlantGrowth dataset in R. We’ll just go through the steps here and explain it in the next section.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the data</span>
  <span class="kw">data</span>(<span class="st">&quot;PlantGrowth&quot;</span>)

<span class="co"># Look at the first few lines of it</span>
  <span class="kw">head</span>(PlantGrowth)
##   weight group
## 1   4.17  ctrl
## 2   5.58  ctrl
## 3   5.18  ctrl
## 4   6.11  ctrl
## 5   4.50  ctrl
## 6   4.61  ctrl
  
<span class="co"># Examine the data structure</span>
  <span class="kw">str</span>(PlantGrowth)
## &#39;data.frame&#39;:    30 obs. of  2 variables:
##  $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
##  $ group : Factor w/ 3 levels &quot;ctrl&quot;,&quot;trt1&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
  
<span class="co"># Fit an ANOVA to the data and store it as an object</span>
  plant_model =<span class="st"> </span><span class="kw">lm</span>(weight<span class="op">~</span>group, <span class="dt">data=</span>PlantGrowth)

<span class="co"># Check the model diagnostics to make sure we haven&#39;t blown any assumptions</span>
<span class="co"># too badly and to make sure the model fit is reasonable before we start to</span>
<span class="co"># put any stock into the results</span>
  <span class="kw">plot</span>(plant_model)    </code></pre></div>
<p><img src="04_anova_files/figure-html/unnamed-chunk-3-1.png" width="576" /><img src="04_anova_files/figure-html/unnamed-chunk-3-2.png" width="576" /><img src="04_anova_files/figure-html/unnamed-chunk-3-3.png" width="576" /><img src="04_anova_files/figure-html/unnamed-chunk-3-4.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  
<span class="co"># Now print the anova table. Note that when we have grouping variables like this</span>
<span class="co"># we need to use the `anova` function to get factor-level statistics like these:</span>
  <span class="kw">anova</span>(plant_model)
## Analysis of Variance Table
## 
## Response: weight
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## group      2  3.7663  1.8832  4.8461 0.01591 *
## Residuals 27 10.4921  0.3886                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
  
<span class="co"># Summarize the model, look at the coefficients, standard errors, and R-squared</span>
  <span class="kw">summary</span>(plant_model)
## 
## Call:
## lm(formula = weight ~ group, data = PlantGrowth)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0710 -0.4180 -0.0060  0.2627  1.3690 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
## grouptrt1    -0.3710     0.2788  -1.331   0.1944    
## grouptrt2     0.4940     0.2788   1.772   0.0877 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6234 on 27 degrees of freedom
## Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
## F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre></div>
<p><br></p>
<p>That’s all there is to it!</p>
<p><br></p>
</div>
</div>
<div id="what-does-it-mean" class="section level2">
<h2>What does it mean?</h2>
<p><br></p>
<p>Okay, now that we have all of this neat output, what does it all mean? Let’s go through it all step by step.</p>
<p><strong>1)</strong> The first thing we did was fit the model with the <code>lm</code> function. This not only ran the model, but it stored the model as an object in R so we could run diagnostics and summarize our results.</p>
<p><strong>2)</strong> Next, we used the <code>plot</code> function to look at some model diagnostics. The first plot showed us the residuals vs the fitted values. What we are looking for here is to make sure that there are no obvious patterns in the residuals with respect to the fitted values. Everything looks okay here for now.</p>
<p>The second plot is also very important. If all is well in the model fit, the q-q plot should look like a diagonal line with points falling more-or-less on the line. In this case, it is not perfect, but we are probably okay.</p>
<p>The third plot is a check to see if the residuals change with x (like the first) based on a square-root transform. Although we see a slight trend here, probably not anything to worry about.</p>
<p>Finally, the last plot shows the <code>leverage</code> exerted by individual points. Some points far out on the ends of the data or outliers can exert undue influence on the fit of a line. In the case of this diagnostic and the <code>Cook's D</code> we usually like to see all or a large majority of the points falling between -3 and 3 on the y-axis. So, this diagnostic checks out as well.</p>
<p><strong>3)</strong> After we actually check our assumptions and model fit, we can look at the results of the model. First, we calculate the ANOVA table for the fitted model using the aptly named <code>anova</code> function in R. This function gives us the standard ANOVA table showing sums of squares and mean squared errors for our grouping variable(s) and the model residuals (unexplained variance). The <code>anova</code> function also gives us the F-statistic for our group effects and the p-value associated with that. Note that this kind of summary is the only way to obtain such a value. Note that we can calculate the R-squared directly from this table as:</p>
<p><span class="math display">\[R^2 = \frac{SSB}{SSB + SSR}\]</span></p>
<p><span class="math inline">\(\\\)</span></p>
<p><span class="math display">\[R^2 = \frac{3.7663}{3.7663+10.49291}\]</span></p>
<p><span class="math inline">\(\\\)</span></p>
<p><span class="math display">\[R^2 = 0.264131\]</span></p>
<p><strong>4)</strong> That’s really all we need to report for a one-way ANOVA, but we can get some of this info from the model using <code>summary</code> as well. For instance, note that <code>summary(plant_model)</code> also returns an R-sqaured value if you forget the calculation. It is identical to ours.</p>
<p><br></p>
</div>
<div id="communicating-the-results" class="section level2">
<h2>Communicating the results</h2>
<p><br></p>
<p>Here is a quick mock-up of what this might look like in the methods and results section of a (bad) paper:</p>
<p><br></p>
<div id="methods" class="section level3">
<h3>Methods</h3>
<p><br></p>
<p><em>Data analysis</em><br />
We used one-way analysis of variance (ANOVA) to test the effects of treatment group (trt1, trt2, and ctrl) on the mass of plants (g). The null hypothesis for this test was that all group means were equal: <span class="math inline">\(H_0: \mu_1= \mu_2 = \mu_3\)</span>. We examined diagnostic plots to assess assumptions of normality in the residuals, verify homoscedasticity of errors, and determine the presence of influential observations in the data.</p>
<p>We determined differences between group means using a Tukey-Kramer pairwise comparison of means to control for Type-I error rates. All tests assumed a Type-I error rate of <span class="math inline">\(\alpha\)</span> = 0.05, and statistical significance was inferred at p &lt; 0.05.</p>
<p><br></p>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<p><br></p>
<p>Mass of plants varied significantly between treatment groups (ANOVA, F = 4.846, df<sub>1</sub> = 2, df<sub>2</sub> = 27, p = 0.016; Table 1). The differences between groups explained about 26% of the variation in mass (R<sup>2</sup> = 0.26). The mass of plants in the trt2 group (5.5 <span class="math inline">\(\pm\)</span> 0.4 g) was significantly greater than plants in the <code>trt1</code> group (4.7 <span class="math inline">\(\pm\)</span> 0.8 g) in this study (Tukey HSD, p = 0.012; Fig. 1). We failed to detect differences in mass between plants in the control group (5.0 <span class="math inline">\(\pm\)</span> 0.6 g) and <code>trt1</code> (p = 0.39) or <code>trt2</code> (p = 0.20).</p>
<p><br></p>
</div>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License.</a></p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
