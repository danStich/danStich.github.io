<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="..\..\styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 678</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Teaching
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../teaching.html">Teaching home</a>
    </li>
    <li>
      <a href="../../classes/BIOL217/index.html">BIOL 217</a>
    </li>
    <li>
      <a href="../../classes/BIOL678/index.html">BIOL 678</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../research.html">Research</a>
</li>
<li>
  <a href="../../studentProjects.html">Current Students</a>
</li>
<li>
  <a href="../../publications.html">Publications</a>
</li>
<li>
  <a href="../../cv.html">CV</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/danStich">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="diagnostics-and-effect-sizes" class="section level1">
<h1>Diagnostics and effect sizes</h1>
<p><img src="../../images/watch.jpg" alt=""></p>
<h2 id="multi">
Introduction
</h2>
<p>The objective of this assignment is to take a step back and evaluate the assumptions that we make when we conduct parametric tests and create linear models that we use to explain data or make predictions. This week we will start with how we can test our assumptions, and then move on to how we communicate our results with respect to effects of explanatory variables on our response of interest.</p>
<p>This lab will continue to build on our work with linear models in R, and will help us understand exactly why we use these methods, how we we use them to draw inference, and how to interpret the results. In addition to building these critical skills, the lab will also serve to set the stage for the next several weeks of class during which we will examine a more generalized framework (the GLM).</p>
<p>By the end of this lab, you should be able to: 1) conduct visual assessment of the validity of assumptions related to linear models on a case-by-case basis, and 2) be able to compute and communicate effects of explanatory variables on a response of interest.</p>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<h3 id="multi">
Regression diagnostics
</h3>
<p>Let’s begin by doing some model diagnostics for a linear model. Remember, this should really be the first step, along with data exploration, in any analysis that you conduct using linear models. Let’s start off this week with the <code>ToothGrowth</code> data that some of you explored during the first lab. These data are from an experiment that studied the effects of three different doses of Vitamin C using one of two supplement types on the length of guinea pig teeth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the ToothGrowth dataset</span>
  <span class="kw">data</span>(<span class="st">&quot;ToothGrowth&quot;</span>)

<span class="co"># To learn more about the data set, you can do</span>
  ?ToothGrowth

<span class="co"># Take a look at the structure of the data</span>
  <span class="kw">str</span>(ToothGrowth)</code></pre></div>
<p>Dose is stored as a numeric variable, and that makes intuitive sense. However, we only have three different doses, so if we are assuming that dose is numeric, then we also need to assume that it is being randomly sampled from a population of potential doses, which I think is clearly not the case here (otherwise we would have some that weren’t a nice round number). So, we should probably convert this to a factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Convert the dose variable to a factor</span>
  ToothGrowth<span class="op">$</span>dose =<span class="st"> </span><span class="kw">as.factor</span>(ToothGrowth<span class="op">$</span>dose)</code></pre></div>
<p>Now, let’s get diagnosing.</p>
<p>The first thing we will do is check to see if the distribution of the data are normal within groups. We can do this with a couple of tools. First, make a boxplot of tooth length (<code>'len'</code>) as a function of supplement type and dose.</p>
<p><strong>Question 1.</strong> Based on the boxplot, does it appear that the distribution of tooth lengths is fairly normal within doses? What other kinds of plots could you use to visually inspect these distributions (note: not the residuals yet)?</p>
<p>Next, we can look at the actual regression diagnostics to examine whether or not we are in major violation of assumptions about the residuals in our model. Remember, the two assumptions related to the residuals are 1) they are normally distributed with a mean of zero, and 2) homogeneity of variance.</p>
<p>Start by fitting a model to test the additive effects of the supplement (<code>supp</code>) and doseage (<code>dose</code>) on tooth length (<code>len</code>) in guinea pigs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Remember to store the model as an object,</span>
<span class="co"># like this, replacing the &#39;&#39;...&#39; in</span>
<span class="co"># parentheses with the appropriate </span>
<span class="co"># formula and data arguments. Cruel, #Iknow.</span>
  tooth.mod =<span class="st"> </span><span class="kw">lm</span>(...)</code></pre></div>
<p>Next, graph the diagnostic plots of the residual error for the fitted model object using the <code>plot</code> function. See the <a href="05_diagnosticsAndEffects.html"> lecture module </a> for an example of how to do this. Remember, you can use the <code>mfrow</code> argument in the <code>par</code> function to get all four of these plots in one window if you prefer not to flip through them one by one.</p>
<p><strong>Question 2.</strong> Based on our discussions about residual plots this week and the examples in the <a href="05_diagnosticsAndEffects.html"> lecture module </a>, does it appear that the residuals in the plots you made are (more or less) normally distributed with a mean of zero? How did you come to this conclusion?</p>
<p><strong>Question 3.</strong> Based on the residual plots you have made and our discussions, does it appear that your model violates the assumption about homogeneity of variances? How did you come to <em>this</em> conclusion?</p>
<div id="interpreting-main-effects" class="section level3">
<h3>Interpreting main effects</h3>
<p>Once you are satisfied that you have adequately reviewed the diagnostic plots and developed an opinion about whether or not we are violating assumptions, let’s move on.</p>
<p>Now that we’ve done a little model validation to assure that we are not completely blowing the assumptions of linear models (hopefully you concluded this as well), it is time to take a look at our results. We will do this one step at a time. First, print the output of your model using the <code>anova</code> function to determine whether or not the main effects of each explanatory variable were significant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get the ANOVA table for your model,</span>
<span class="co"># replacing &#39;tooth.mod&#39; with </span>
<span class="co"># whatever you named the model object.</span>
  <span class="kw">anova</span>(tooth.mod)</code></pre></div>
<p><strong>Question 4.</strong> Were there significant effects of supplement and/or dose on guinea pig tooth length?</p>
<p><strong>Question 5.</strong> How much of the variability in guinea pig tooth length was explained by the additive effects of supplement and dose? Remember, there are multiple ways to find this information. If you can’t remember either method, check the <a href="04_linearModels.html">linear models tutorial</a> from last week or <code>Google</code> it.</p>
<p>If you haven’t already done so, print a summary of the linear model so you can see the regression coefficients. Using what you learned in class this week, and the 1000-line long <a href="05_diagnosticsAndEffects.html"> lecture module </a> that your wicked awesome prof made for you this week, predict the mean expected value of tooth length for each combination of <code>supp</code> and <code>dose</code>. <em>Remember:</em> there are multiple ways to do this. All are in the <a href="05_diagnosticsAndEffects.html"> lecture module </a> from this week. You can do the math by hand, or you can use the built-in <code>predict</code> function in R. Just pay close attention to how you do this, and make sure that your predictions make reasonable sense (they should if you do it correctly).</p>
<p><strong>Question 6.</strong> Report the model-predicted tooth length for each combination of supplement and dose.</p>
<p>Next, calculate the observed mean of tooth length for each combination of supplement and dose. The easiest way to do this is with the ddply function in the <code>plyr</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the plyr package</span>
  <span class="kw">library</span>(plyr)
  
<span class="co"># Check out the function if you&#39;ve forgotten how to use it  </span>
  ?ddply</code></pre></div>
<p><strong>Question 7.</strong> Do the model predictions of tooth length for each combination of supplement and dose approximate the values and patterns in the observed data reasonably well? Describe any discrepencies you notice.</p>
<p><img src="hw05_diagnosticsAndEffects_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="interpreting-interactions" class="section level3">
<h3>Interpreting interactions</h3>
<p>Okay, now that you’ve had a chance to examine the simple model and take note of some differences between the observed data and the predictions, let’s go ahead and step up the complexity a little more.</p>
<p>The reason that our predictions did not match the observed data is because the model that we built allowed for different intercepts between the two levels of <code>supp</code>, but did not allow the effect of dose to differ between supplementation types. In order to account for this, we can include an <em>interaction</em> in our model, like we talked about in class.</p>
<p>Go ahead and fit a new model to the ToothGrowth data, this time including the interaction between <code>supp</code> and <code>dose</code>. Once you’ve fit the model, summarize it using both the <code>anova</code> function and the <code>summary</code> function.</p>
<p><strong>Question 8.</strong> Is the interaction term in this model significant?</p>
<p><strong>Question 9.</strong> How much variability in guinea pig tooth length is explained by this model? Is that more or less than the model that did not include the interaction?</p>
<p>Finally, use one of the methods from the <a href="05_diagnosticsAndEffects.html"> lecture module </a> to plot the predicted values of guinea pig tooth length for each combination of supplement and dose using the model that included the interaction term. To do this, you will want to use the built-in <code>predict</code> function in R. This can get a little messy, so I will help you along your way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, we need to get all combinations</span>
<span class="co"># of the unique values for supplement</span>
<span class="co"># type and dose. To do this, we will</span>
<span class="co"># use the &#39;expand.grid&#39; function. Note that we are</span>
<span class="co"># basically telling R to cross tabulate all of the unique values of </span>
<span class="co"># supplement type with all of the unique values of dose</span>
  levels =<span class="st"> </span><span class="kw">expand.grid</span>(<span class="kw">unique</span>(ToothGrowth<span class="op">$</span>supp), <span class="kw">unique</span>(ToothGrowth<span class="op">$</span>dose))
  
<span class="co"># Give the new df names.</span>
<span class="co"># These names have to match the</span>
<span class="co"># names of the variables</span>
<span class="co"># used in fitting the model</span>
  <span class="kw">names</span>(levels) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;supp&#39;</span>, <span class="st">&#39;dose&#39;</span>)
  
<span class="co"># Sort the dataframe by supplement for</span>
<span class="co"># ease of plotting later on</span>
  levels =<span class="st"> </span>levels[<span class="kw">with</span>(levels, <span class="kw">order</span>(supp)), ]  </code></pre></div>
<p>Now, you can make predictions using the predict function. Or, if you are a total masochist, you can do the calculations by hand using what you learned in lecture this week and the info you have in the <a href="05_diagnosticsAndEffects.html"> lecture module </a> .</p>
<p><img src="hw05_diagnosticsAndEffects_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Once you have the predictions, plot the observed data and add your predictions to the plots using the <code>lines</code> function like we used in the <a href="05_diagnosticsAndEffects.html"> lecture module </a> . <strong>One bonus point</strong> if you can get the observed data to plot by their own colors and get your predicted lines to match those colors like above. The plot will have a lot more meaning to the reader if you can make these kinds of distinctions. See the <a href="05_diagnosticsAndEffects.html"> lecture module </a> for guidance on how to make a pretty graph of your observed data and predictions.</p>
<p><strong>Question 10.</strong> Now that you’ve had a chance to look at these things side by side, does the interaction model appear to make more intuitive sense than the main effects model? Is this supported by the amount of variability is explained by each of the models?</p>
<p>Wouldn’t it be nice to have some kind of really reliable statistic that you could use to clearly demonstrate this difference?…stay tuned for more on this topic.</p>
</div>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
