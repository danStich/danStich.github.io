<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">danStich</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../../index.html">Home</a>
</li>
<li>
  <a href="../../teaching.html">Teaching</a>
</li>
<li>
  <a href="../../research.html">Research</a>
</li>
<li>
  <a href="../../cv.html">Curriculum vitae</a>
</li>
<li>
  <a href="../../courseWebsites.html">Course websites</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}

.column {
    float: left;
    padding: 15px;
}

.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

.content {
    width: 75%;
}

</style>
<p><br></p>
<div id="probability-distributions" class="section level1">
<h1>Probability distributions</h1>
<p><br></p>
<p><img src="hw02_probabilityDists_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto auto auto 0;" /></p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The objective of this assignment is to apply what you have been learning in R in order to start learning about more about sampling distributions and how they apply to designing your thesis research. We have discussed a number of probability distributions in the exponential family of distributions, and now it is time to put that talk into action.</p>
<p>By the end of this lab, you should be able to 1) simulate data from a wide variety of probability distributions in the exponential family, 2) calculate summary statistics for any sampling distribution that you come across, and 3) estimate the parameters of some probability distributions using the method of moments and/or maximum likelihood estimation.</p>
</div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<h3>
The normal distribution
</h3>
<p>Let’s start with the normal distribution to knock the rust off and get ourselves thinking about probability distributions again. Recall that we can simulate data from the normal using something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ndata =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">30</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>)</code></pre></div>
<p><br></p>
<p>In this example, we have drawn <strong>30</strong> random samples from a normal distribution with a <em>mean</em> of 0 and a <em>standard deviation</em> of 1. Also recall that we can plot these data as samples from a <strong>continuous distribution</strong> using a curved line in R to see if it looks like it should:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(<span class="kw">density</span>(ndata),
     <span class="dt">main=</span><span class="st">&#39;&#39;</span>,
     <span class="dt">xlab=</span><span class="kw">expression</span>(theta),
     <span class="dt">col=</span><span class="st">&#39;red&#39;</span>,
     <span class="dt">lwd=</span><span class="st">&#39;2&#39;</span>)</code></pre></div>
<p><img src="hw02_probabilityDists_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now, what if I gave you the following plot and asked you if you could find parameters of the normal distribution from which these samples were drawn?</p>
<p><img src="hw02_probabilityDists_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Question 1.</strong> What are the approximate mean and standard deviation of the distribution that has been sampled here? Play with the <code>rnorm</code> function in R and change the values of the mean and standard deviation until you are able to approximately replicate the graph above. Use the <code>hist</code> function to plot the data each time you simulate them to check if the pattern is close. <strong>NOTE</strong>: You will be able to zero in on this faster if you use large sample sizes for n, <strong>but</strong> if n is too large it will take a long time to simulate each data set.</p>
<p>What a pain, but it’s good to see how these parameters change the shape and location of the sampling distribution so we can understand what they do.</p>
<p>Now let’s take a look at another way to do this. This time, instead of handing you a histogram, a researcher has provided you with the following data set for a project on which you are working. In this case it is for diastolic blood pressure measurements from 10,000 physically fit people (totally made up).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># I&#39;ll simulate the data for you</span>
<span class="co"># in another file and you can read</span>
<span class="co"># in the data from a text file like</span>
<span class="co"># this (just make sure it is in</span>
<span class="co"># the correct directory):</span>
  dbp =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dbp.txt&#39;</span>) 
  <span class="kw">str</span>(dbp)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    205 obs. of  1 variable:
##  $ x: int  167 166 87 63 76 77 71 70 69 75 ...</code></pre>
<p><br></p>
<p><strong>Question 2.</strong> Calculate the mean and <em>variance</em> of this distribution using the method of moments. Note that you can write your own function (as in the reference script), or you can use the built-in R functions that we talked about in class this week (see reference script). What are the mean and sd using this method?</p>
<p><strong>Quesiton 3.</strong> Now calculate the <em>mean</em> and the <em>variance</em> of this sampling distribution using maximum likelihood estimation. Recall that you can estimate the parameters using <code>optim()</code> and by writing out the likelihood inside of a function, or you can use in the built-in <code>fitdistr</code> function in R. If you do the latter, remember to pay attention to the answers that R gives you.</p>
<p><strong>Question 4.</strong> Calculate the 95% confidence limits for this distribution using the <code>quantile</code> function. Remember to think carefully about what probabilities you need to use for the 95% CI.</p>
<div id="the-beta-distribution" class="section level3">
<h3>The beta distribution</h3>
<p>We talked about this distribution in class this week, and about how useful it can be due to its flexibility. However, given that the Beta is controlled by two shape parameters, it can be tough to wrap your head around. Let’s play.</p>
<p>Simulate <strong>10,000</strong> random draws with parameters <span class="math inline">\(\alpha\)</span> <strong>(<code>shape1</code> in R) = 30</strong> and <span class="math inline">\(\beta\)</span> <strong>(<code>shape2</code> in R) = 12</strong> and plot a histogram of the draws:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get a random sample from the beta</span>
beta.sample =<span class="st"> </span><span class="kw">rbeta</span>(<span class="dt">n=</span><span class="fl">1e4</span>,
                    <span class="dt">shape1=</span><span class="dv">30</span>,
                    <span class="dt">shape2=</span><span class="dv">12</span>)

<span class="co"># Plot a histogram</span>
<span class="kw">hist</span>(beta.sample, <span class="dt">main=</span><span class="st">&#39;&#39;</span>, <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>)</code></pre></div>
<p><img src="hw02_probabilityDists_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Question 5.</strong> Now, play with <code>shape1</code> and <code>shape2</code> parameters in the code above to answer the following questions.</p>
<ol style="list-style-type: lower-alpha">
<li>What happens when you make the numbers approximately equal?<br />
</li>
<li>What happens to the histogram when <code>shape1</code> is much larger than <code>shape2</code>?<br />
</li>
<li>What happents to the histogram when <code>shape2</code> is much larger?<br />
</li>
<li>Set both parameters to 500. What happens to the variance of the distribution?</li>
<li>Now set both parameters to 2. How does this compare to the previous?<br />
</li>
<li>Set both parameters to 1. Now what does the histogram look like?<br />
</li>
<li>What happens to the histogram if you set both parameters to 0.65?</li>
</ol>
</div>
<div id="the-bernoulli-distribution" class="section level3">
<h3>The Bernoulli distribution</h3>
<p>Take a random draw from a Bernoulli distribution. Remember, this distribution is the one that is like flipping a coin one time and the only parameter that controls the distribution is the probability of success:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rlab)                      <span class="co"># Load the package</span>
bern.sample =<span class="st"> </span><span class="kw">rbern</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">prob=</span>.<span class="dv">5</span>)  <span class="co"># Take a random sample from the Bernoulli</span></code></pre></div>
<p><br></p>
<p><strong>Question 6.</strong> If you take 2,500 samples instead of just one in the code above, what is the total number of trials that result in success (the ones that are a ‘1’)? Use the built in R functions to figure this out, don’t try to count all 2,500 elements in the vector.</p>
<p><strong>Question 7.</strong> How does this compare to what you expected?</p>
</div>
<div id="the-binomial-distribution" class="section level3">
<h3>The binomial distribution</h3>
<p>Remember the binomial distribution is like the Bernoulli, but instead of flipping one coin at a time, we are flipping <span class="math inline">\(N\)</span> number of coins (<code>size</code>) per trial:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rbinom</span>(<span class="dt">n=</span><span class="dv">10</span>, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span><span class="fl">0.5</span>)</code></pre></div>
<pre><code>##  [1] 3 4 5 7 6 6 2 5 4 8</code></pre>
<p><br></p>
<p><strong>Question 8.</strong> Imagine that there is an 85% chance of surviving a procedure. If the procedure was performed on 14 patients (<code>size</code>) by each surgeon in my operating room next year, what is the average number I should expect to survive if I have 13 surgeons (<code>n</code>) and patient survival is independent of surgeon? (I know you can do the math by hand- not the point of the exercise).</p>
</div>
<div id="the-poisson-distribution" class="section level3">
<h3>The Poisson distribution</h3>
<p>Recall that the Poisson distribution was created to explain the number of events that occur over some period of time. We can simulate data from the Poisson using (for example):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">lambda =</span> <span class="dv">10</span>)</code></pre></div>
<pre><code>##  [1]  5  6  7  4 12  9  9  8  7  9</code></pre>
<p><br></p>
<p>The code above takes 10 random samples from a Poisson distribution with a mean (and variance!) of 10.</p>
<p>Suppose that we are interested in describing the distribution of the genus <em>Photinus</em> in Upstate New York. We collected as many speciments as we could in jars (at this point if you’re really confused then Google it) each night on 10 different nights at ten of our field sites. Now we want to know what is the mean and variance of the number of <em>Photinus</em> we caught each of those 10 nights in each of ten jars so we can compare these numbers to historical data.</p>
<p><strong>Question 9.</strong> Using the data in the file <code>counts.txt</code> (you have to read it in first), estimate the mean and variance for the number of Photinus per night using any method appropriate for these data (see above or below for data read: <strong>I want you to adapt this code</strong>).</p>
<p>Suppose that the data in question 9 looked more like those contained in this file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counts2 =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;counts2.txt&#39;</span>)</code></pre></div>
<p><br></p>
<p><strong>Question 10.</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Is the mean of the data in <code>counts2</code> similar to that in <code>counts</code>?</p></li>
<li><p>What about the median?</p></li>
<li><p>Do they look the same when you plot them?</p></li>
<li><p>If not, what type of distribution is represented by these data?</p></li>
<li><p>Calculate the parameters of it using maximum likelihood estimation.</p></li>
</ol>
</div>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License.</a></p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
