                 
  model {                       

    # Likelihood and residuals
      for(i in 1:nobs){  
        # Likelihood
          N[i] ~ dpois(lambda[i])
          log(lambda[i]) <- alpha[color[i]] + beta[color[i]]*mass[i]
          
        # Calculations for assessing model fit
          # Pearson residuals (aka standardized residuals)
            pResid[i] <- N[i] - lambda[i]/sqrt(lambda[i])

          # Make a new set of observations 
          # that conform perfectly to the posterior distribution
            N.new[i] ~ dpois(lambda[i])

          # Pearson residuals for the data that conform perfectly
            pResidN[i] <- N.new[i] - lambda[i]/sqrt(lambda[i])

          # Calculate squared residuals for model fit and predictive fit
            D[i] <- pow(pResid[i], 2)
            Dnew[i] <- pow(pResidN[i], 2)
      }

    # Priors
      for(j in 1:ncolors){
        alpha[j] ~ dnorm(0, 0.01)
        beta[j] ~ dnorm(0, 0.01) 
      }

    # Discrepency measures
      fitted <- sum(D[])
      predicted <- sum(Dnew[])
  }                             
    

