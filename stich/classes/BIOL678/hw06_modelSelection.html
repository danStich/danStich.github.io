<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">danStich</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../../index.html">Home</a>
</li>
<li>
  <a href="../../teaching.html">Teaching</a>
</li>
<li>
  <a href="../../research.html">Research</a>
</li>
<li>
  <a href="../../cv.html">Curriculum vitae</a>
</li>
<li>
  <a href="../../courseWebsites.html">Course websites</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}

.column {
    float: left;
    padding: 15px;
}

.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

.content {
    width: 75%;
}

</style>
<p><br></p>
<div id="model-selection" class="section level1">
<h1>Model selection</h1>
<p><br></p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This week we are going to wrap up our discussions about linear models. In reality, our discussions and the exercises that we have been doing related to model diagnostics, interpretation, and selection apply broadly to a larger class of models of which linear models are a special case, so we will continue to apply these tools during the next three weeks of lab. The objectives of this lab are to introduce some new kinds of explanatory variables (“polynomials”), provide you with some tools for choosing between models (start thinking of these as competing hypotheses), and show you how to present the results of hypothesis testing within this framework.</p>
<p>By the end of this lab, you should 1) be comfortable fitting and interpretting linear models such as ANOVA, linear regression, and ANCOVA, 2) be able to state competing hypotheses represented by different models, and 3) be able to use modern tools to choose between competing hypotheses and make predictions that can be used to test the overall quality of your “best” model.</p>
<p><br></p>
</div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<p>This week, we are going to work with some data from species counts on the Galapagos Islands. The data for these exercises are stored on the course website on blackboard:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Alternatively, you could install the &#39;faraway&#39; package in R, and you can get</span>
<span class="co"># the data using data(&quot;gala&quot;):</span>
  <span class="co">#install.packages(&#39;faraway&#39;)</span>
  <span class="kw">library</span>(faraway)
  <span class="kw">data</span>(gala)
  
<span class="co"># The data explanation follows:</span>
### Species:   number of plant species found on the island
### Endemics:  number of endemic species
### Area:      area of the island (km$^2$)
### Elevation: highest elevation of the island (m)
### Nearest:   distance from the nearest island (km)
### Scruz:     distance from Santa Cruz island (km)
### Adjacent:  area of the adjacent island (square km)
  
<span class="co"># The citation for the paper is:   </span>
  
## Johnson, M. P., and P. H. Raven. 1973. Species number and endemism: The
##     Galapagos Archipelago revisited. Science 179:893-895.</code></pre></div>
<p><br></p>
<p><em><strong>Question 1.</strong></em> Thinking back to last week and our discussions about assumptions of linear models, and setting the stage for next week….What is the problem with using species counts as a continuous response variable in linear models?</p>
<p><br></p>
<div id="interpreting-polynomials" class="section level3">
<h3>Interpreting polynomials</h3>
<p>The first thing we will do this week is lay out an example to help you interpret polynomial terms in regression analyses- just to make sure this concept is crystal clear. We will use the data from Johnson and Raven (1973) to demonstrate this concept. A major finding of this paper was that the relationship between species number on a given island and the area of an island was “non-linear”. That study used <span class="math inline">\(log_e\)</span> transformation to demonstrate this. We will try to use a polynomial to see if we can show this another way.</p>
<p><br></p>
<p><em><strong>Question 2.</strong></em> Given what you have learned in other courses (e.g. BIOL 181), what would you expect the relationship between island area and species number to look like? Would you expect the number of species to increase indefinitely with island area? Is there any reason to suspect that the number of species would ever decrease with continued increases in area?</p>
<p><br></p>
<p>Fit a model that includes both linear and quadratic effects of Area on Species.</p>
<p><br></p>
<p><em><strong>Question 3.</strong></em> What is the coefficient of determination (R<sup>2</sup>) of this model? How does this compare the the R<sup>2</sup> values reported for the models in Johnson and Raven (1973)?</p>
<p><br></p>
<p><em><strong>Question 4.</strong></em> Based on the hypothesis that you gave above, do the results of this regression make sense to you? Why or why not? HINT: you <em>can</em> tell from the signs of the two regression coefficients whether or not the results fall in line with your hypothesis (Google it), but if you are in a pinch, you could also use the coefficients to make some quick predictions and plot them against the raw data.</p>
<p><br></p>
<p>In any case, it looks like we won’t be refuting any seminal papers about species abundances in the Galapagos Islands this week. Oh, well. At least we can use the paper to guide us through the rest of our lab.</p>
<p><br></p>
</div>
<div id="model-selection-1" class="section level3">
<h3>Model selection</h3>
<p>Now that we have looked at how the form of our model might change based on the underlying characteristics of our study system (or at least our assumptions about them), let us have a look at how we choose between competing hypotheses that attempt to explain the same phenomenon.</p>
<p><br></p>
<p>For a change of pace from previous labs, let’s keep following the Johnson and Raven (1973) paper down the rabbit hole. Let’s have some fun!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The models that Johnson and Raven tested looked like this</span>

  <span class="co"># Note: the results will not be exactly the same because the dill-weed that</span>
  <span class="co"># wrote the faraway package added data for the missing data in the paper</span>

  <span class="co"># Note Also: we need to fix data point number 25 in Scruz because that is the</span>
  <span class="co"># island Scruz and we can&#39;t take the log of zero!!!</span>
    gala<span class="op">$</span>Scruz[<span class="dv">25</span>] =<span class="st"> </span><span class="fl">0.00001</span>

S1 =<span class="st"> </span><span class="kw">lm</span>(Species<span class="op">~</span>Area <span class="op">+</span><span class="st"> </span>Nearest <span class="op">+</span><span class="st"> </span>Scruz <span class="op">+</span><span class="st"> </span>Adjacent, <span class="dt">data=</span>gala)
lnS1 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(Species)<span class="op">~</span><span class="kw">log</span>(Area) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Nearest) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Scruz) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Adjacent),
            <span class="dt">data=</span>gala)
S2 =<span class="st"> </span><span class="kw">lm</span>(Species<span class="op">~</span>Area <span class="op">+</span><span class="st"> </span>Elevation <span class="op">+</span><span class="st"> </span>Nearest <span class="op">+</span><span class="st"> </span>Scruz <span class="op">+</span><span class="st"> </span>Adjacent, <span class="dt">data=</span>gala)
lnS2 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(Species)<span class="op">~</span><span class="kw">log</span>(Area) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Elevation) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Nearest) <span class="op">+</span><span class="st"> </span>
<span class="st">            </span><span class="kw">log</span>(Scruz) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Adjacent), <span class="dt">data=</span>gala          )</code></pre></div>
<p><br></p>
<p><br></p>
<p><em><strong>Question 5.</strong></em> Look at the summaries for each of these models once you fit them. Does the general pattern in the R-squared values for these four models follow what you might expect to see for the same models as they are presented in Table 3 from Johnson and Raven (1973)?</p>
<p><br></p>
<p>This paper was written before information theory became widespread, and in fact the study was done the year before Hiortugo Akaike published his <a href="http://www.unt.edu/rss/class/Jon/MiscDocs/Akaike_1974.pdf">seminal 1974 paper</a> in which he revolutionized model selection (although he introduced the concept as part of a conference proceedings the year before).</p>
<p><br></p>
<p>Let’s see what would have happened if Johnson and Raven had waited a year to publish! We will compare the two best models from that paper to evaluate parsimony of the closely-ranked models.</p>
<p><br></p>
<p>We will use the <code>AICcmodavg</code> introduced in class for this example, but recall that we could use the <code>AIC</code> function in <span class="math inline">\(R\)</span> for this as well. Using the latter approach, you would have to calculate the sample-size corrected <span class="math inline">\(AICc_i\)</span>, <span class="math inline">\(delta AICc_i\)</span>, and <span class="math inline">\(w_i\)</span> manually.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install and load the necessary library</span>
  <span class="kw">install.packages</span>(<span class="st">&#39;AICcmodavg&#39;</span>)
  <span class="kw">library</span>(AICcmodavg)

<span class="co"># Next, you will need to make a list out of your models</span>
  mods =<span class="st"> </span><span class="kw">list</span>(lnS1, lnS2)
<span class="co"># Make sure you give it some names, too</span>
  <span class="kw">names</span>(mods) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;lnS1&#39;</span>, <span class="st">&#39; lnS2&#39;</span>)</code></pre></div>
<p><br></p>
<p>Now, use the <code>aictab</code> function to calculate model selection statistics for information-theoretic approach using AIC. If you’ve forgotten how to do this, you can Google it, or you can do:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?aictab</code></pre></div>
<p><br></p>
<p><br></p>
<p><em><strong>Question 6.</strong></em> Is there a clear best model in this case? Defend your answer based on the general rules of thumb that we talked about in class, including <span class="math inline">\(delta AICc\)</span> and the ratio of <span class="math inline">\(w_i\)</span> for the two models (see reference script).</p>
<p><br></p>
<p><em><strong>Question 7.</strong></em> How do the results of your AIC model selection compare to the R<sup>2</sup> values you calculated for each of these models above? Why do you think this is the case?</p>
<p><br></p>
<p><em><strong>Question 8.</strong></em> Now that you have these two models, I want you to choose two additional models (combinations of explanatory variables) that you are interested in testing against the best models of Johnson and Raven (1973). Give the formula for each of those models here. Please note that you will need to use the <span class="math inline">\(log_e\)</span> transformation of the response that Johnson and Raven used in order to compare these models with <span class="math inline">\(AICc\)</span>, but you do not need to <span class="math inline">\(log_e\)</span> transform the explanatory variables if you do not wish to.</p>
<p><br></p>
<p>First, fit your new models and make a list object containing these two models and lnS1 and lnS2 from above. Don’t forget to assign names to your list (see example above). Now, use the AICc model selection method from above to compare your models to the results of lnS1 and lnS2.</p>
<p><br></p>
<p><em><strong>Question 9.</strong></em> How do your models compare to the models of Johnson and Raven (1973) with respect to the model selection statistics?</p>
<p><br></p>
<p><br></p>
</div>
<div id="model-validation" class="section level3">
<h3>Model validation</h3>
<p>Trucking on…First, we will use the best model from Johnson and Raven (1973) to do some model validation using one of the methods we discussed in class this week.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># As a reminder, here is the model that you should be working with for this:</span>
  lnS1 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(Species)<span class="op">~</span><span class="kw">log</span>(Area) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Nearest) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Scruz) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(Adjacent),
            <span class="dt">data=</span>gala)

  <span class="kw">summary</span>(lnS1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Species) ~ log(Area) + log(Nearest) + log(Scruz) + 
##     log(Adjacent), data = gala)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.61494 -0.44016 -0.01009  0.47420  1.39483 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    3.13231    0.22380  13.996 2.48e-13 ***
## log(Area)      0.39389    0.04383   8.987 2.64e-09 ***
## log(Nearest)  -0.09074    0.10833  -0.838    0.410    
## log(Scruz)    -0.03025    0.05413  -0.559    0.581    
## log(Adjacent) -0.02448    0.04698  -0.521    0.607    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7955 on 25 degrees of freedom
## Multiple R-squared:  0.7768, Adjusted R-squared:  0.7411 
## F-statistic: 21.75 on 4 and 25 DF,  p-value: 7.731e-08</code></pre>
<p><br></p>
<p>Use one of the methods from the reference script (<em>leave-one-out cross-validation</em> or <em>bootstrapped predictive</em> R<sup>2</sup>) to do some model validation on this model. Alternatively, you can choose to use one of the alternative methods from the <code>caret</code> package or the <code>DAAG</code> package if you are feeling adventurous, but I will leave it to you to do the research on that one if you choose it. <em>Note</em>: you do not need to make any plots for the above, but it is strongly encouraged.</p>
<p><br></p>
<p>Use the same method to do model validation on the best model in your model set from question 9.</p>
<p><br></p>
<p><em><strong>Question 10.</strong></em> How do the model validation results for these two models compare? Is one clearly better than the other? If there were not a clear difference between these models, what is one tool we learned about this week that could be used to incorporate this uncertainty in our interpretation of the results?</p>
</div>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License.</a></p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
