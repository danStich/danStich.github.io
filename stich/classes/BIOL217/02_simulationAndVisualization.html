<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>02_simulationAndVisualization.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="..\..\styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 217</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Teaching
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../teaching.html">Teaching home</a>
    </li>
    <li>
      <a href="../../classes/BIOL217/index.html">BIOL 217</a>
    </li>
    <li>
      <a href="../../classes/BIOL678/index.html">BIOL 678</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../research.html">Research</a>
</li>
<li>
  <a href="../../studentProjects.html">Current Students</a>
</li>
<li>
  <a href="../../publications.html">Publications</a>
</li>
<li>
  <a href="../../cv.html">CV</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/danStich">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<h1 id="multi">
Data simulation and visualization
</h1>
<p><img src="../../images/matrixSmolt.jpg" alt=""></p>
<h2 id="multi">
Introduction
</h2>
<p>The purpose of this unit is to get you comfortable simulating data in R and give you some tools for vizualizing the data that you have simulated or collected. This is not meant to be a comprehensive treatment of these subjects but rather an introduction to the tools that are available to you. Similarly, this is just meant to get you started. There are a lot of tools out there and you may come up with something that works better for you once you have some basics under your belt.</p>
<blockquote>
<p><strong>Why are we talking about simulating data?</strong></p>
</blockquote>
<p>There are a few good reasons for this:</p>
<ol style="list-style-type: decimal">
<li><p>Data simulation is a powerful tool in experimental design, and can help address problems before they arise.</p></li>
<li><p>Tools used for data simulation are similar or the same as many of the tools that you will need for manipulating and analyzing data.</p></li>
<li><p>Simulation can be as useful on the back end of statistical analyses as it is for experimental design. For example, we need to simulate data to make predictions in many cases.</p></li>
</ol>
<blockquote>
<p><strong>And data visualization- why do we care?</strong></p>
</blockquote>
<ol style="list-style-type: decimal">
<li><p>There are few statistical tests that hold intuitive meaning to our readers. The ability to present information in a visually meaningful way to the reader can help to make the interpretation of your science crystal clear without having to worry about whether or not your reader has the faculties to interpret the results of statistical tests.</p></li>
<li><p>Effects and effect sizes are often (if not always) more important than the ability to detect ‘significant’ differences. If you can present clear evidence that some treatment or manipulation confers a biologically meaningful change in a visual way alongside these tests, you can provide a much stronger body of evidence with which to argue your case.</p></li>
<li><p>There are a few graphical tools that are very useful for basic data exploration, diagnostics, etc., that can make your life a lot easier for data analysis and interpretation. They can also help you decide whether something has gone terribly wrong.</p></li>
</ol>
<div id="simulating-data-in-r" class="section level2">
<h2>Simulating data in R</h2>
<p>There are a lot of tools specifically created for simulating data in R. We can’t even begin to cover them all, but we can build up a basic working knowledge of some of those that are more essential. This week we will look at some simple, common tools for basic data generation. Next week, we will extend this to include more on probability distributions.</p>
<p>There are a lot of different reasons why we might want to simulate data, from creating derived variables, to data organization, variable coding, power analyses, model predictions and validation, and ‘heuristic’ exercises.</p>
<p>Let’s start with some really simple functions in R.</p>
<p>We can simulate data in two ways: deterministically and stochastically.</p>
<p><strong>Deterministic</strong>: this one is well defined. Here we are usually talking about assigning a variable based on some known characteristic or an error-free mathematical calculation.</p>
<p><strong>Stochastic</strong>: this one is looser. Here we are usually talking about things like random number generation, subsampling, and a variety of other more advanced techniques. The objective usually is to incorporate some aspect of probability or uncertainty. This uncertainty can either be due to process error or observation error.</p>
<p>Process error is due to real ‘noise’ in a study system. It can, in itself, be a focus of very interesting research. A common source of process error in biological studies is individual variability (e.g., phenotypic variability).</p>
<p>Observation error can be thought of as ‘false’ noise in the study system that has been introduced due to our inability to perfectly observe some process of interest). This more commonly is thought of as a nuisance to be accounted for in many contemporary studies, but can also be an interesting field of inquiry in its own right. A common cause of observation error is imperfect detection of individuals or species in field surverys.</p>
<div id="deterministic-simulation" class="section level3">
<h3>Deterministic simulation</h3>
<p>By nature, deterministic simulation is inherently more boring than stochastic simulation, because relationships are known. This usually is manifested in the form of data manipulation, categorical or ordinal variable assignments, or calculation of derived quantities. We might also think of these simply as “transformations” of variables.</p>
<div id="data-read" class="section level4">
<h4>Data read</h4>
<p>Let’s start by reading in a data file- this time we use <strong>real</strong> data. These are sex-specific length-at-age data for American shad (<em>Alosa sapidissima</em>) from the Connecticut River. The data currently are being used in some models that I maintain with collaborators from NOAA Fisheries, the US Geological Survey, and US Fish and Wildlife Service. The data were provided by CT Department of Energy and Environmental Protection and come from adult fish that are returning to the river from the ocean to spawn.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Start by reading in the data from the class website</span></a>
<a class="sourceLine" id="cb1-2" title="2">  am_shad &lt;-<span class="st">  </span><span class="kw">read.csv</span>(<span class="st">&quot;ctr_fish.csv&quot;</span>)</a></code></pre></div>
<p>Always a good idea to look at the first few lines of data to make sure nothing looks ‘fishy’. Haha, I couldn’t help myself.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Look at the first 10 rows</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="kw">head</span>(am_shad, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">   Sex Age Length yearCollected backCalculated Mass</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="dv">1</span>    B   <span class="dv">1</span>     <span class="dv">13</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="dv">2</span>    B   <span class="dv">1</span>     <span class="dv">15</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="dv">3</span>    B   <span class="dv">1</span>     <span class="dv">15</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dv">4</span>    B   <span class="dv">1</span>     <span class="dv">15</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="dv">5</span>    B   <span class="dv">1</span>     <span class="dv">15</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="dv">6</span>    B   <span class="dv">1</span>     <span class="dv">15</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="dv">7</span>    B   <span class="dv">1</span>     <span class="dv">16</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="dv">8</span>    B   <span class="dv">1</span>     <span class="dv">16</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="dv">9</span>    B   <span class="dv">1</span>     <span class="dv">16</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="dv">10</span>   B   <span class="dv">1</span>     <span class="dv">16</span>          <span class="dv">2010</span>           <span class="ot">TRUE</span>   <span class="ot">NA</span></a></code></pre></div>
<p>The NAs are supposed to be there- they are missing data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Look at the structure of the data</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">str</span>(am_shad)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">   </span><span class="dv">16946</span> obs. of  <span class="dv">6</span> variables<span class="op">:</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st"> </span><span class="er">$</span><span class="st"> </span>Sex           <span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">2</span> levels <span class="st">&quot;B&quot;</span>,<span class="st">&quot;R&quot;</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</a>
<a class="sourceLine" id="cb3-5" title="5"> <span class="op">$</span><span class="st"> </span>Age           <span class="op">:</span><span class="st"> </span>int  <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</a>
<a class="sourceLine" id="cb3-6" title="6"> <span class="op">$</span><span class="st"> </span>Length        <span class="op">:</span><span class="st"> </span>num  <span class="dv">13</span> <span class="dv">15</span> <span class="dv">15</span> <span class="dv">15</span> <span class="dv">15</span> <span class="dv">15</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">16</span> <span class="dv">16</span> ...</a>
<a class="sourceLine" id="cb3-7" title="7"> <span class="op">$</span><span class="st"> </span>yearCollected <span class="op">:</span><span class="st"> </span>int  <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> <span class="dv">2010</span> ...</a>
<a class="sourceLine" id="cb3-8" title="8"> <span class="op">$</span><span class="st"> </span>backCalculated<span class="op">:</span><span class="st"> </span>logi  <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> <span class="ot">TRUE</span> ...</a>
<a class="sourceLine" id="cb3-9" title="9"> <span class="op">$</span><span class="st"> </span>Mass          <span class="op">:</span><span class="st"> </span>int  <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> <span class="ot">NA</span> ...</a></code></pre></div>
</div>
<div id="data-explanation-metadata" class="section level4">
<h4>Data explanation (“metadata”):</h4>
<p>There are about 17k observations (rows) of 6 variables here:</p>
<p><code>Sex</code>: fish gender. <code>B</code> stands for ‘buck’ (males), <code>R</code> stands for ‘roes’ (females).<br />
<code>Age</code>: an integer describing fish age.<br />
<code>Length</code>: fish length at age (cm).<br />
<code>yearCollected</code>: the year in which the fish was caught.<br />
<code>backCalculated</code>: a logical indicating whether or not the length of the fish was back-calculated from aging.<br />
<code>Mass</code>: the mass of indnividual fish (in grams). Note that this is NA for all ages that were estimated from hard structures (so all cases for which <code>backCalculated == TRUE</code>).</p>
</div>
<div id="example-1.-creation-of-new-grouping-variable-based-on-some-criterion" class="section level4">
<h4>Example 1. Creation of new grouping variable based on some criterion</h4>
<p>We could artificially classify fish into ‘big’ and ‘small’ groups if we wanted to for some reason. To do something like that, we have a couple of options</p>
<ol style="list-style-type: decimal">
<li>Loop approach with conditional: despite some of the benefits, we try to avoid this approach in R for more purely vectorized solutions where possible, mostly because of performance issues.</li>
</ol>
<p>Pros: pretty easy to understand the syntax and read.<br> Cons: extra code to write loops can be pretty slow in R.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># We define some iterator &#39;i&#39; to run this for </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># each row from 1 to the number of rows in our data.</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(am_shad)){              </a>
<a class="sourceLine" id="cb4-4" title="4">    </a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="co"># Then, we say that if length is </span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="co"># greater than some threshold...</span></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="cf">if</span>(am_shad<span class="op">$</span>Length[i] <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>){</a>
<a class="sourceLine" id="cb4-8" title="8">      </a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="co"># ...the length group is assigned the value &#39;big&#39;...</span></a>
<a class="sourceLine" id="cb4-10" title="10">      am_shad<span class="op">$</span>length_group[i] &lt;-<span class="st"> &#39;big&#39;</span></a>
<a class="sourceLine" id="cb4-11" title="11">      </a>
<a class="sourceLine" id="cb4-12" title="12">    <span class="co"># ...otherwise...  </span></a>
<a class="sourceLine" id="cb4-13" title="13">      } <span class="cf">else</span> { </a>
<a class="sourceLine" id="cb4-14" title="14">        <span class="co"># ...length group is assigned the value &#39;small&#39;</span></a>
<a class="sourceLine" id="cb4-15" title="15">          am_shad<span class="op">$</span>length_group[i] &lt;-<span class="st"> &#39;small&#39;</span></a>
<a class="sourceLine" id="cb4-16" title="16">      }</a>
<a class="sourceLine" id="cb4-17" title="17">  </a>
<a class="sourceLine" id="cb4-18" title="18">  } <span class="co"># Close the loop</span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>A faster method is to used vectorized logical tests. Note that this still creates the variable on the fly, and does the assignment much more quickly even though the code is somewhat redundant. But, it can be a little tougher to read at first.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">am_shad<span class="op">$</span>length_group[am_shad<span class="op">$</span>Length <span class="op">&lt;=</span><span class="st"> </span><span class="dv">30</span>] &lt;-<span class="st"> &#39;small&#39;</span></a>
<a class="sourceLine" id="cb5-2" title="2">am_shad<span class="op">$</span>length_group[am_shad<span class="op">$</span>Length <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>] &lt;-<span class="st"> &#39;big&#39;</span></a></code></pre></div>
<p>A host of new(er) R functions are dedicated to doing this using the same vectorizations but with syntax that is a bit easier to read. I encourage you to explore those options as your skills build during this class.</p>
</div>
<div id="example-2.-derived-quantity-based-on-a-mathematical-formula." class="section level4">
<h4>Example 2. Derived quantity based on a mathematical formula.</h4>
<p>If we have a formula that relates two variables, we could predict one based on the other deterministically.</p>
<p>For example, I have fit a length-weight regression to explain the relationship between <code>Length</code> and <code>Mass</code> using the <code>am_shad</code> data.</p>
<p>This relationship looks like your old friend <span class="math inline">\(y = mx + b\)</span>, the equation for a line, but we log10-transform both of the variables before fitting the line (more to come later in the class). For now, we can predict our <strong>independent variable</strong> (<code>Mass</code>) from our dependent variable (<code>Length</code>) if we plug in new values for <code>Length</code> and the <strong>parameters</strong> of the line.</p>
<p>In this case, I know that <code>m</code> = 3.0703621, and <code>b</code> = -1.9535405.</p>
<p>If I plug these numbers in to the equation above, I can predict <code>log10(Mass)</code> for new lengths <code>log10(Length)</code>:</p>
<p><span class="math inline">\(log_{10}Mass = 3.0703621 \cdot log_{10}Length - 1.9535405\)</span></p>
<p>In R, this looks like:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Parameters from length-weight regression</span></a>
<a class="sourceLine" id="cb6-2" title="2">  m &lt;-<span class="st"> </span><span class="fl">3.0703621</span></a>
<a class="sourceLine" id="cb6-3" title="3">  b &lt;-<span class="st"> </span><span class="fl">1.9535405</span></a>
<a class="sourceLine" id="cb6-4" title="4">  </a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co"># Make a sequence of new lengths based on range in data,</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co"># then take the log of the whole thing all at once.</span></a>
<a class="sourceLine" id="cb6-7" title="7">  log_length &lt;-<span class="st"> </span><span class="kw">log10</span>(<span class="kw">seq</span>(<span class="kw">min</span>(am_shad<span class="op">$</span>Length), <span class="kw">max</span>(am_shad<span class="op">$</span>Length), <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-8" title="8"> </a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co"># Calculate a new thing (log10_mass) using parameters for line</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co"># and sequence of new log10_length.</span></a>
<a class="sourceLine" id="cb6-11" title="11">  log_mass &lt;-<span class="st"> </span>m <span class="op">*</span><span class="st"> </span>log_length <span class="op">+</span><span class="st"> </span>b</a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co"># Plot the prediction</span></a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="kw">plot</span>(<span class="dt">x =</span> log_length, <span class="dt">y =</span> log_mass, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="stochastic-simulation" class="section level3">
<h3>Stochastic simulation</h3>
<p>As mentioned above, the point of stochastic simulation is usually to account for uncertainty in some process (i.e. we could just pick a single value if we knew it). This is almost always done probabilistically. There are a number of ways we could do this. One is by drawing from some probability distribution that we have described, and the other is by randomly sampling data that we have (need for tools like ‘bootstrapping’).</p>
<div id="example-1.-random-samples-from-a-dataset" class="section level4">
<h4>Example 1. Random samples from a dataset</h4>
<p>Let’s say we want to take random samples from our huge data set so we can fit models to a subset of data and then use the rest of our data for model validation</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Randomly sample 100 rows of data from our data frame two different</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># times to see the differences</span></a>
<a class="sourceLine" id="cb7-3" title="3">  samp1 &lt;-<span class="st"> </span>am_shad[<span class="kw">sample</span>(<span class="kw">nrow</span>(am_shad), <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb7-4" title="4">  samp2 &lt;-<span class="st"> </span>am_shad[<span class="kw">sample</span>(<span class="kw">nrow</span>(am_shad), <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co"># We can look at them with our histograms </span></a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="kw">hist</span>(samp1<span class="op">$</span>Length, <span class="dt">main =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))</a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="kw">hist</span>(samp2<span class="op">$</span>Length, <span class="dt">main =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>))</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>We could also loop this to get a dynamic look at what our sampling does. <em>Note: change the size of the sample (‘n’ below) and you can see the effect of sample size on the shape of the distribution we assume.</em></p>
<p>We’ll modify our histogram now, as well.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">  n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>){</a>
<a class="sourceLine" id="cb9-3" title="3">    samp &lt;-<span class="st"> </span>am_shad[<span class="kw">sample</span>(<span class="kw">nrow</span>(am_shad), <span class="dt">size=</span>n, <span class="dt">replace=</span><span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb9-4" title="4">    <span class="kw">hist</span>(samp<span class="op">$</span>Length, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">60</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, n), <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>, <span class="dt">main=</span><span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="kw">Sys.sleep</span>(<span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb9-6" title="6">  }</a></code></pre></div>
</div>
<div id="example-2.-random-samples-from-a-distribution" class="section level4">
<h4>Example 2. Random samples from a distribution</h4>
<p>Now, instead of sampling our data let’s say we have some distribution from which we would like to use information</p>
<p>Let’s make a distribution.</p>
<p>We will start with the normal, and we can move into others next week when we talk about probability distributions and sample statistics. For this, we will use the distribution of American shad lengths for age-6 females because it approximates a normal distribution: <strong>Notice</strong> that we are adding more and more complexity into our histogram code!</p>
<p>Start by looking at the size distribution for age-7 females:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">hist</span>(am_shad<span class="op">$</span>Length[am_shad<span class="op">$</span>Sex<span class="op">==</span><span class="st">&#39;R&#39;</span> <span class="op">&amp;</span><span class="st"> </span>am_shad<span class="op">$</span>Age<span class="op">==</span><span class="dv">6</span>],</a>
<a class="sourceLine" id="cb10-2" title="2">     <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,</a>
<a class="sourceLine" id="cb10-3" title="3">     <span class="dt">main=</span><span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb10-4" title="4">     <span class="dt">xlab=</span><span class="st">&#39;Forklength (cm)&#39;</span></a>
<a class="sourceLine" id="cb10-5" title="5">     )</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Let’s make that query into an object now, and we</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># Make a new object with our fish</span></a>
<a class="sourceLine" id="cb11-2" title="2">  age6_Roes &lt;-<span class="st"> </span>am_shad<span class="op">$</span>Length[am_shad<span class="op">$</span>Sex<span class="op">==</span><span class="st">&#39;R&#39;</span> <span class="op">&amp;</span><span class="st"> </span>am_shad<span class="op">$</span>Age<span class="op">==</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb11-3" title="3">  </a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># Get the mean and variance</span></a>
<a class="sourceLine" id="cb11-5" title="5">  mu &lt;-<span class="st"> </span><span class="kw">mean</span>(age6_Roes)</a>
<a class="sourceLine" id="cb11-6" title="6">  sigma &lt;-<span class="st"> </span><span class="kw">sd</span>(age6_Roes)</a></code></pre></div>
<p><br></p>
<blockquote>
<p>Quick aside:</p>
</blockquote>
<p>We will get into this next week, but for now it may be helpful to know that a normal distribution is described by two parameters:</p>
<ol style="list-style-type: decimal">
<li>The mean (<span class="math inline">\(\mu\)</span>)</li>
<li>The standard deviation (<span class="math inline">\(\sigma\)</span>, or the variance as <span class="math inline">\(\sigma^2\)</span>).</li>
</ol>
<blockquote>
<p>Back to our example</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Now, we can use the mean and </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co"># standard deviation to randomly sample</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co"># our normal distribution of lengths.</span></a>
<a class="sourceLine" id="cb12-4" title="4">  length_sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">10000</span>, <span class="dt">mean=</span>mu, <span class="dt">sd=</span>sigma)</a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co"># Plot the sample to see if it is a normal- YAY it is!</span></a>
<a class="sourceLine" id="cb12-7" title="7">  <span class="kw">hist</span>(length_sample,</a>
<a class="sourceLine" id="cb12-8" title="8">       <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,</a>
<a class="sourceLine" id="cb12-9" title="9">       <span class="dt">main=</span><span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb12-10" title="10">       <span class="dt">xlab=</span><span class="st">&#39;Forklength (cm)&#39;</span></a>
<a class="sourceLine" id="cb12-11" title="11">       )</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>And, just as a check to make sure this is accurate, let’s go ahead and plot our new distribution over the top of the histogram of our <em>original</em> data <em>Note</em>: we will look at how to modify these plots below, just run the code for now.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">  <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="kw">hist</span>(am_shad<span class="op">$</span>Length[am_shad<span class="op">$</span>Sex<span class="op">==</span><span class="st">&#39;R&#39;</span> <span class="op">&amp;</span><span class="st"> </span>am_shad<span class="op">$</span>Age<span class="op">==</span><span class="dv">6</span>],</a>
<a class="sourceLine" id="cb13-3" title="3">       <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,</a>
<a class="sourceLine" id="cb13-4" title="4">       <span class="dt">main=</span><span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb13-5" title="5">       <span class="dt">xlab=</span><span class="st">&#39;Forklength (cm)&#39;</span>,</a>
<a class="sourceLine" id="cb13-6" title="6">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>)</a>
<a class="sourceLine" id="cb13-7" title="7">       )</a>
<a class="sourceLine" id="cb13-8" title="8">  <span class="kw">par</span>(<span class="dt">new=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb13-9" title="9">  <span class="kw">plot</span>(<span class="kw">density</span>(length_sample),</a>
<a class="sourceLine" id="cb13-10" title="10">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),</a>
<a class="sourceLine" id="cb13-11" title="11">       <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>,</a>
<a class="sourceLine" id="cb13-12" title="12">       <span class="dt">main=</span><span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb13-13" title="13">       <span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,</a>
<a class="sourceLine" id="cb13-14" title="14">       <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb13-15" title="15">  <span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">las=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="some-simple-graphs-in-r" class="section level2">
<h2>Some simple graphs in R</h2>
<p>Let’s look at a few simple kinds of plots in R. The basic graphics in R are not much to look at. But, there are a <strong>ton</strong> of ways to modify these plots, and there are even whole packages like <code>ggplot</code> that are dedicated to improving data visualization in R.</p>
<div id="histograms" class="section level3">
<h3>Histograms</h3>
<p>First, let’s come back to our histogram. The function <code>hist</code> plots the actual histogram, and like other plotting utilities, can take a wide variety of arguments, all of which are optional with the exception of the data that we want to plot. This is the case for most plotting functions in the base graphics for R.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Get data for age six females, and make a histogram</span></a>
<a class="sourceLine" id="cb14-2" title="2">  lengths &lt;-<span class="st"> </span>am_shad<span class="op">$</span>Length[am_shad<span class="op">$</span>Sex<span class="op">==</span><span class="st">&#39;R&#39;</span> <span class="op">&amp;</span><span class="st"> </span>am_shad<span class="op">$</span>Age<span class="op">==</span><span class="dv">6</span>]   </a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="kw">hist</span>(lengths)             </a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>This is really ugly, but easy enough to fix. Have a look at what everything is doing in the code below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Par is a function that controls graphical parameters in the active</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># graphics device. Here, we are using it to set the margin widths outside</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># the plotting area (with the argument &#39;mar&#39;). Take a look at the graphical</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co"># parameters available in R by using ?par</span></a>
<a class="sourceLine" id="cb15-5" title="5">    <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>))      </a>
<a class="sourceLine" id="cb15-6" title="6">  <span class="co"># Let&#39;s break down the histogram function</span></a>
<a class="sourceLine" id="cb15-7" title="7">    <span class="kw">hist</span>(</a>
<a class="sourceLine" id="cb15-8" title="8">      lengths,                <span class="co"># Data that we want to use for histogram</span></a>
<a class="sourceLine" id="cb15-9" title="9">      <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,             <span class="co"># Fill color (different for different plot type)</span></a>
<a class="sourceLine" id="cb15-10" title="10">      <span class="dt">main=</span><span class="st">&#39;&#39;</span>,                <span class="co"># Title for graph, I tend to leave blank</span></a>
<a class="sourceLine" id="cb15-11" title="11">      <span class="dt">xlab=</span><span class="st">&#39;Forklength (cm)&#39;</span>, <span class="co"># x-axis label, a character string</span></a>
<a class="sourceLine" id="cb15-12" title="12">      <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),           <span class="co"># Limits of x-axis as min and max</span></a>
<a class="sourceLine" id="cb15-13" title="13">      <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>,               <span class="co"># y-axis display- none in this case- see others</span></a>
<a class="sourceLine" id="cb15-14" title="14">      <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>               <span class="co"># Same</span></a>
<a class="sourceLine" id="cb15-15" title="15">    )</a>
<a class="sourceLine" id="cb15-16" title="16">  <span class="co"># We can make the axes look a lot better if we just place them by hand</span></a>
<a class="sourceLine" id="cb15-17" title="17">  <span class="co"># The &#39;axis&#39; funcction let&#39;s us draw axes on sides 1(bottom), 2(left),</span></a>
<a class="sourceLine" id="cb15-18" title="18">  <span class="co"># 3(top), and 4(right)</span></a>
<a class="sourceLine" id="cb15-19" title="19">    <span class="kw">axis</span>(</a>
<a class="sourceLine" id="cb15-20" title="20">      <span class="dt">side=</span><span class="dv">2</span>, <span class="co"># Left side</span></a>
<a class="sourceLine" id="cb15-21" title="21">      <span class="dt">las=</span><span class="dv">2</span>,  <span class="co"># Rotate so numbers are horizontal</span></a>
<a class="sourceLine" id="cb15-22" title="22">      <span class="dt">pos=</span><span class="dv">0</span>   <span class="co"># Position the axis at zero instead of negative buffer</span></a>
<a class="sourceLine" id="cb15-23" title="23">    )  </a>
<a class="sourceLine" id="cb15-24" title="24">  <span class="co"># And now for a nice x-axis</span></a>
<a class="sourceLine" id="cb15-25" title="25">    <span class="kw">axis</span>(</a>
<a class="sourceLine" id="cb15-26" title="26">      <span class="dt">side=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb15-27" title="27">      <span class="dt">pos=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb15-28" title="28">      <span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">60</span>, <span class="dt">by=</span><span class="dv">10</span>),    <span class="co"># We can tell R where to put ticks</span></a>
<a class="sourceLine" id="cb15-29" title="29">      <span class="dt">labels=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">60</span>, <span class="dt">by=</span><span class="dv">10</span>) <span class="co"># And add labels (can be different!)</span></a>
<a class="sourceLine" id="cb15-30" title="30">    )</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Much better, right?</p>
</div>
<div id="scatter-plots" class="section level3">
<h3>Scatter plots</h3>
<p>Now let’s make a scatter plot:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Data screening - get rid of bad lengths</span></a>
<a class="sourceLine" id="cb16-2" title="2">  shad &lt;-<span class="st"> </span>am_shad[am_shad<span class="op">$</span>Length <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>, ]</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># Start with a simple scatterplot of age on length</span></a>
<a class="sourceLine" id="cb16-5" title="5">  <span class="kw">plot</span>(<span class="dt">x=</span>shad<span class="op">$</span>Age, <span class="dt">y=</span>shad<span class="op">$</span>Length)</a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<blockquote>
<p><strong>Ugly!!</strong></p>
</blockquote>
<p>So, let’s make it a little nicer.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># First, let&#39;s make a new column to hold age</span></a>
<a class="sourceLine" id="cb17-2" title="2">  shad<span class="op">$</span>Age2 &lt;-<span class="st"> </span>shad<span class="op">$</span>Age</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># Now, we will add a small number to the age of roes to offset the points</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># in our graph so things are clearer. Note that &#39;ggplot2&#39; has built in</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co"># functions for this, and you may prefer them; just remember that the more</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co"># you rely on packages like that, the more you sacrifice the freedom</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co"># inherent in using base functions in R for things like data visualization</span></a>
<a class="sourceLine" id="cb17-8" title="8">  shad<span class="op">$</span>Age2[shad<span class="op">$</span>Sex<span class="op">==</span><span class="st">&#39;R&#39;</span>] &lt;-<span class="st"> </span>shad<span class="op">$</span>Age2[shad<span class="op">$</span>Sex<span class="op">==</span><span class="st">&#39;R&#39;</span>] <span class="fl">+.1</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co"># Make the plot</span></a>
<a class="sourceLine" id="cb17-10" title="10">  <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>))   <span class="co"># Notice that we are shrinking top and right marg.</span></a>
<a class="sourceLine" id="cb17-11" title="11">  <span class="kw">plot</span>(<span class="dt">x=</span>shad<span class="op">$</span>Age2,     <span class="co"># Variable to be plotted on x-axis (independent)</span></a>
<a class="sourceLine" id="cb17-12" title="12">    <span class="dt">y=</span>shad<span class="op">$</span>Length,      <span class="co"># Variable to be plotted on y-axis (dependent)</span></a>
<a class="sourceLine" id="cb17-13" title="13">    <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">21</span>),     <span class="co"># Change the point type (google &#39;pch r&#39; for lists)</span></a>
<a class="sourceLine" id="cb17-14" title="14">    <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>,      <span class="co"># Black outlines for our circles</span></a>
<a class="sourceLine" id="cb17-15" title="15">    <span class="dt">bg =</span> <span class="kw">c</span>(<span class="st">&#39;black&#39;</span>, <span class="st">&#39;gray40&#39;</span>)[shad<span class="op">$</span>Sex], <span class="co"># Sex-specific fills</span></a>
<a class="sourceLine" id="cb17-16" title="16">    <span class="dt">xlab =</span> <span class="st">&#39;Age (years)&#39;</span>,                <span class="co"># X-axis label</span></a>
<a class="sourceLine" id="cb17-17" title="17">    <span class="dt">yaxt =</span> <span class="st">&#39;n&#39;</span>,         <span class="co"># Don&#39;t plot y-axis, we&#39;ll make one</span></a>
<a class="sourceLine" id="cb17-18" title="18">    <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>,          <span class="co"># No y-axis label, let&#39;s make it cool (ok, nerdy),</span></a>
<a class="sourceLine" id="cb17-19" title="19">    <span class="dt">cex =</span> <span class="fl">1.5</span>,          <span class="co"># Make the points big- be proud of your data!</span></a>
<a class="sourceLine" id="cb17-20" title="20">    <span class="dt">cex.axis =</span> <span class="fl">1.15</span>,    <span class="co"># Magnification for font on tick mark labels</span></a>
<a class="sourceLine" id="cb17-21" title="21">    <span class="dt">cex.lab =</span> <span class="fl">1.5</span>       <span class="co"># Magnification for x-lab, slightly larger to show</span></a>
<a class="sourceLine" id="cb17-22" title="22">  )                     <span class="co"># Close call to plot</span></a>
<a class="sourceLine" id="cb17-23" title="23">  <span class="co"># Y-axis</span></a>
<a class="sourceLine" id="cb17-24" title="24">    <span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>,      <span class="co"># Axis goes on the left side (#2)</span></a>
<a class="sourceLine" id="cb17-25" title="25">      <span class="dt">las=</span><span class="dv">2</span>,            <span class="co"># Rotate by 90 degrees</span></a>
<a class="sourceLine" id="cb17-26" title="26">      <span class="dt">cex.axis=</span><span class="fl">1.15</span>     <span class="co"># Magnification to match call to plot</span></a>
<a class="sourceLine" id="cb17-27" title="27">    )</a>
<a class="sourceLine" id="cb17-28" title="28">  <span class="co"># Y-axis label: look what&#39;s going on below!</span></a>
<a class="sourceLine" id="cb17-29" title="29">    <span class="co"># mtext lets us plot text in the margins of each axis</span></a>
<a class="sourceLine" id="cb17-30" title="30">    <span class="kw">mtext</span>(</a>
<a class="sourceLine" id="cb17-31" title="31">    <span class="co"># Side refers to the side of the plotting area, 1 to 4 from top to</span></a>
<a class="sourceLine" id="cb17-32" title="32">    <span class="co"># right counter clockwise</span></a>
<a class="sourceLine" id="cb17-33" title="33">      <span class="dt">side=</span><span class="dv">2</span>,  </a>
<a class="sourceLine" id="cb17-34" title="34">    <span class="co"># &#39;expression&#39; let&#39;s us include all kinds of special formatting like</span></a>
<a class="sourceLine" id="cb17-35" title="35">    <span class="co"># the subscript in the example below, but also superscripts, and</span></a>
<a class="sourceLine" id="cb17-36" title="36">    <span class="co"># special characters like interpuncts, Greek letters, etc. It can be</span></a>
<a class="sourceLine" id="cb17-37" title="37">    <span class="co"># a lot of fun for making super nerdy axes for your graphs and very</span></a>
<a class="sourceLine" id="cb17-38" title="38">    <span class="co"># powerful in terms of freedom in the range of options you have. Note</span></a>
<a class="sourceLine" id="cb17-39" title="39">    <span class="co"># that special characters usually require the UTF-8 code for a symbol.</span></a>
<a class="sourceLine" id="cb17-40" title="40">    <span class="co"># For example, if you wanted the interpunct, it would be entered in</span></a>
<a class="sourceLine" id="cb17-41" title="41">    <span class="co"># the paste statement as &#39;\u00b7&#39;.</span></a>
<a class="sourceLine" id="cb17-42" title="42">      <span class="kw">expression</span>(  </a>
<a class="sourceLine" id="cb17-43" title="43">        <span class="kw">paste</span>(              <span class="co"># Paste concatenates chr strings in order</span></a>
<a class="sourceLine" id="cb17-44" title="44">          <span class="st">&#39;Fork length ( &#39;</span>, <span class="co"># First character string- note spaces matter!</span></a>
<a class="sourceLine" id="cb17-45" title="45">          <span class="st">&quot;L&quot;</span>[<span class="st">&quot;f&quot;</span>],         <span class="co"># Second, square brackets mean &#39;subscript&#39;</span></a>
<a class="sourceLine" id="cb17-46" title="46">          <span class="st">&quot; , cm)&quot;</span>,         <span class="co"># Third, spaces count!</span></a>
<a class="sourceLine" id="cb17-47" title="47">          <span class="co"># Tell R you want no characters to seperate your text strings</span></a>
<a class="sourceLine" id="cb17-48" title="48">          <span class="co"># listed above</span></a>
<a class="sourceLine" id="cb17-49" title="49">          <span class="dt">sep=</span><span class="st">&#39;&#39;</span> </a>
<a class="sourceLine" id="cb17-50" title="50">        )                   <span class="co"># Close call to paste</span></a>
<a class="sourceLine" id="cb17-51" title="51">      ),                    <span class="co"># Close call to expression</span></a>
<a class="sourceLine" id="cb17-52" title="52">      <span class="dt">cex =</span> <span class="fl">1.5</span>,            <span class="co"># Magnification to match x-axis label above</span></a>
<a class="sourceLine" id="cb17-53" title="53">      <span class="dt">line =</span> <span class="dv">3</span>              <span class="co"># Tell R what vertical line WRT to ordinate</span></a>
<a class="sourceLine" id="cb17-54" title="54">    ) <span class="co"># Close call to mtext</span></a>
<a class="sourceLine" id="cb17-55" title="55">    </a>
<a class="sourceLine" id="cb17-56" title="56">  <span class="co"># And, just because R is AWESOME and we want to start unleashing the</span></a>
<a class="sourceLine" id="cb17-57" title="57">  <span class="co"># darkside of the force, let&#39;s add a sweet graphical legend!</span></a>
<a class="sourceLine" id="cb17-58" title="58">    <span class="co"># Sweet female digraph in dark gray with light gray shadow</span></a>
<a class="sourceLine" id="cb17-59" title="59">      <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">6.04</span>, <span class="dt">y=</span><span class="fl">19.97</span>, <span class="st">&quot;\u2640&quot;</span>, <span class="dt">cex=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&#39;gray60&#39;</span>)</a>
<a class="sourceLine" id="cb17-60" title="60">      <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">6.01</span>, <span class="dt">y=</span><span class="fl">19.99</span>, <span class="st">&quot;\u2640&quot;</span>, <span class="dt">cex=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&#39;gray40&#39;</span>)</a>
<a class="sourceLine" id="cb17-61" title="61">      <span class="kw">text</span>(<span class="dt">x=</span><span class="dv">6</span>, <span class="dt">y=</span><span class="dv">20</span>, <span class="st">&quot;\u2640&quot;</span>, <span class="dt">cex=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&#39;gray40&#39;</span>)</a>
<a class="sourceLine" id="cb17-62" title="62">    <span class="co"># Sweet male digraph in black with dark gray shadow</span></a>
<a class="sourceLine" id="cb17-63" title="63">      <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">6.76</span>, <span class="dt">y=</span><span class="fl">19.97</span>, <span class="st">&quot;\u2642&quot;</span>, <span class="dt">cex=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&#39;gray60&#39;</span>)   </a>
<a class="sourceLine" id="cb17-64" title="64">      <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">6.73</span>, <span class="dt">y=</span><span class="fl">19.99</span>, <span class="st">&quot;\u2642&quot;</span>, <span class="dt">cex=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</a>
<a class="sourceLine" id="cb17-65" title="65">      <span class="kw">text</span>(<span class="dt">x=</span><span class="fl">6.72</span>, <span class="dt">y=</span><span class="dv">20</span>, <span class="st">&quot;\u2642&quot;</span>, <span class="dt">cex=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>)       </a></code></pre></div>
<p><img src="02_simulationAndVisualization_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Okay, okay, that’s a little overkill, but hopefully it helps you appreciate what you can do when you know how to use the program. We will continue to explore this functionality and more as we work through the course.</p>
<p><br></p>
<p><br></p>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
