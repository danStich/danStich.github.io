<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>05_linearModels.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="..\..\styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 217</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="software.html">Software needs</a>
</li>
<li>
  <a href="resources.html">Additional Resources</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/danStich">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<h1 id="multi">
Linear models
</h1>
<p><img src="../../images/graphs.png"></p>
<h2 id="multi">
Introduction
</h2>
<p>This week, we will introduce a class of statistical tools known collectively as linear models. This class of tools includes such examples as one-way ANOVA, linear regression and correlation, and by extension includes all other n-way ANOVAs, multiple linear regression, and analysis of covariance (ANCOVA). Later this semester, we will see that these models be extended even further to include generalized linear models, generalized linear mixed models, and a number of multivariate techniques for complex data analysis.</p>
<p>So, that said, this week is the gateway into the rest of the world of parametric and semi-parametric statistics. As a result, we will focus primarily on parametric applications this week and next, although we will discuss the simple case of the Kruskal-Wallis test as an alternative to the parametric ANOVA. In two weeks you will know why you will almost never need this test again! The over-arching theme for this week is that any of these methods can be expressed as the formula for a line, which is how they got their names. We will start with ANOVA because it is analagous to many of the methods that we’ve already discussed. However, it is important to recognize that this is just a special case of linear models. We will show this during our discussions this week.</p>
<p>Because we are now entering into the realm of ‘the rest of statistics’ we also need to start ‘talking the talk’ in addition to ‘walking the walk’, so we will practice how to write methods sections for these tests and how to report the results. In reality, once you are comfortable using a couple of functions in R, writing up the methods and results is more challenging than fitting models.</p>
<div id="analysis-of-variance-anova" class="section level2">
<h2>Analysis of variance (ANOVA)</h2>
<h3 id="multi">
One-way ANOVA
</h3>
<p>We will use some of the built-in datasets in R this week to demonstrate our analyses and show how to communicate the methods and the results of our statistical inference.</p>
<p>Let’s start by loading up the <code>PlantGrowth</code> dataset in R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">data</span>(PlantGrowth)</span></code></pre></div>
<p><code>PlantGrowth</code> is a dataframe with 30 observations of two variables. The first variable describes plant growth (in units of mass), and the second variable describes control and treatment groups for individual plants.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">str</span>(PlantGrowth)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">   </span><span class="dv">30</span> obs. of  <span class="dv">2</span> variables<span class="op">:</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st"> </span><span class="er">$</span><span class="st"> </span>weight<span class="op">:</span><span class="st"> </span>num  <span class="fl">4.17</span> <span class="fl">5.58</span> <span class="fl">5.18</span> <span class="fl">6.11</span> <span class="fl">4.5</span> <span class="fl">4.61</span> <span class="fl">5.17</span> <span class="fl">4.53</span> <span class="fl">5.33</span> <span class="fl">5.14</span> ...</span>
<span id="cb2-4"><a href="#cb2-4"></a> <span class="op">$</span><span class="st"> </span>group <span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">3</span> levels <span class="st">&quot;ctrl&quot;</span>,<span class="st">&quot;trt1&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span></code></pre></div>
<p>Let’s begin by using a one-way ANOVA to determine if the mass of plants differs between groups in <code>PlantGrowth</code>. In practice, this is <em>very</em> easy. First of all though, we would report our <strong>methods</strong> something like this:</p>
<blockquote>
<p>We used a one-way analysis of variance (ANOVA) to estimate the effects of treatment group on the mass (g) of plants assuming a Type-I error rate of <span class="math inline">\(\alpha\)</span> = 0.05. Differences between groups were assumed to be significant at p &lt; 0.05.</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Fit the model</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(weight<span class="op">~</span>group, <span class="dt">data=</span>PlantGrowth)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># Print the model object to the console</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>model</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>Call<span class="op">:</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">lm</span>(<span class="dt">formula =</span> weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a>Coefficients<span class="op">:</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>(Intercept)    grouptrt1    grouptrt2  </span>
<span id="cb3-12"><a href="#cb3-12"></a>      <span class="fl">5.032</span>       <span class="fl">-0.371</span>        <span class="fl">0.494</span>  </span></code></pre></div>
<p>Easy to do, but not very useful for getting the information that we need. What we get here is essentially just one part of the information that we would like to (should) report.</p>
<p>If we look at the summary of the output, we can get more of what we need:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Look at a summary of</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># the model object</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">summary</span>(model)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>Call<span class="op">:</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">lm</span>(<span class="dt">formula =</span> weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>Residuals<span class="op">:</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="st">    </span>Min      1Q  Median      3Q     Max </span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="fl">-1.0710</span> <span class="fl">-0.4180</span> <span class="fl">-0.0060</span>  <span class="fl">0.2627</span>  <span class="fl">1.3690</span> </span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>Coefficients<span class="op">:</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="st">            </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb4-14"><a href="#cb4-14"></a>(Intercept)   <span class="fl">5.0320</span>     <span class="fl">0.1971</span>  <span class="fl">25.527</span>   <span class="op">&lt;</span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>grouptrt1    <span class="fl">-0.3710</span>     <span class="fl">0.2788</span>  <span class="fl">-1.331</span>   <span class="fl">0.1944</span>    </span>
<span id="cb4-16"><a href="#cb4-16"></a>grouptrt2     <span class="fl">0.4940</span>     <span class="fl">0.2788</span>   <span class="fl">1.772</span>   <span class="fl">0.0877</span> .  </span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="op">---</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">0.6234</span> on <span class="dv">27</span> degrees of freedom</span>
<span id="cb4-21"><a href="#cb4-21"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.2641</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.2096</span> </span>
<span id="cb4-22"><a href="#cb4-22"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">4.846</span> on <span class="dv">2</span> and <span class="dv">27</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">0.01591</span></span></code></pre></div>
<p>That’s better, we get some useful information here. First of all, we get the value of the test statistic, the df, and the p-value for the model. We also get the <span class="math inline">\(R^2\)</span> for the model: 0.26. This statistic tells us roughly what percentage of the total variance in the data is explained by the model we fit. Another way of thinking of this is as a signal-to-noise ratio. More formally, it is the sum of squares between groups divided by the sum of squares total:</p>
<p><span class="math display">\[R^2 = \frac{SSB}{SST}\]</span></p>
<p>Let’s use the <code>anova</code> function to summarize the object a little further.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Get an ANOVA table for the model</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">anova</span>(model)</span>
<span id="cb5-3"><a href="#cb5-3"></a>Analysis of Variance Table</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>Response<span class="op">:</span><span class="st"> </span>weight</span>
<span id="cb5-6"><a href="#cb5-6"></a>          Df  Sum Sq Mean Sq F value  <span class="kw">Pr</span>(<span class="op">&gt;</span>F)  </span>
<span id="cb5-7"><a href="#cb5-7"></a>group      <span class="dv">2</span>  <span class="fl">3.7663</span>  <span class="fl">1.8832</span>  <span class="fl">4.8461</span> <span class="fl">0.01591</span> <span class="op">*</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>Residuals <span class="dv">27</span> <span class="fl">10.4921</span>  <span class="fl">0.3886</span>                  </span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="op">---</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>Okay, this is really what we needed: an ANOVA table with a break down of the residuals, mean squared errors, etc. And, we can now say:</p>
<blockquote>
<p>We found that the treatment had a significant effect on plant weight (ANOVA, F = 4.846, df<sub>1</sub> = 2, df<sub>2</sub> = 27, p = 0.0159).</p>
</blockquote>
<p><strong>NOTE</strong> that all of these statistics were present in the summary of the model, as well. They just weren’t neatly organized, and we would need to do the calculations by hand to drag them out of it.</p>
<p>But, what if we want to know more about how treatment affected weight? Like, which groups are different? Then, we could use a ‘pair-wise’ comparison to test for differences between factor levels. Because this essentially means conducting a whole bunch of t-tests, we need a way to account for our repeated Type-I error rate, because at <span class="math inline">\(\alpha\)</span> = 0.05 we stand a 1 in 20 chance of falsely rejecting the null even if it is true.</p>
<p>One tool that lets us make multiple comparisons between groups is the Tukey HSD (honest significant difference) test. This test makes comparisons between each group while controlling for Type-I error. Essentially, this makes it harder to detect differences between groups but when we do we are more sure that they are not spurious.</p>
<p>Sound confusing? At least it’s easy to do in R.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># We need to recast this as an ANOVA model with `aov` in R...</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># this is essentially the same thing as the `lm` function, but  </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># in a different wrapper (literally) that allows us to access </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># the info in a different way</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">TukeyHSD</span>(    <span class="co"># The function that does the Tukey test</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="kw">aov</span>(       <span class="co"># A wrapper for lm objects</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>    model    <span class="co"># The model that we ran above</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>    )</span>
<span id="cb6-10"><a href="#cb6-10"></a>  )</span>
<span id="cb6-11"><a href="#cb6-11"></a>  Tukey multiple comparisons of means</span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="dv">95</span>% family<span class="op">-</span>wise confidence level</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>Fit<span class="op">:</span><span class="st"> </span><span class="kw">aov</span>(<span class="dt">formula =</span> model)</span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="op">$</span>group</span>
<span id="cb6-17"><a href="#cb6-17"></a>            diff        lwr       upr     p adj</span>
<span id="cb6-18"><a href="#cb6-18"></a>trt1<span class="op">-</span>ctrl <span class="fl">-0.371</span> <span class="fl">-1.0622161</span> <span class="fl">0.3202161</span> <span class="fl">0.3908711</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>trt2<span class="op">-</span>ctrl  <span class="fl">0.494</span> <span class="fl">-0.1972161</span> <span class="fl">1.1852161</span> <span class="fl">0.1979960</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>trt2<span class="op">-</span>trt1  <span class="fl">0.865</span>  <span class="fl">0.1737839</span> <span class="fl">1.5562161</span> <span class="fl">0.0120064</span></span></code></pre></div>
<p>This report shows us exactly how the response differs with respect to the treatment groups. Here, we see that the only significant difference occurs between <code>trt2</code> and <code>trt1</code>. How do we know this? Based on the p-values…</p>
<p>For the readers, and for us, it may be easier to see this information displayed graphically:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Make a boxplot of weight by group</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># using the PlantGrowth data</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">boxplot</span>(</span>
<span id="cb7-4"><a href="#cb7-4"></a>  weight<span class="op">~</span>group,           <span class="co"># Relationship of interest as formula</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="dt">data=</span>PlantGrowth,       <span class="co"># Name of the data set</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,             <span class="co"># Fill color for boxes</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="dt">ylab=</span><span class="st">&#39;Mass (g)&#39;</span>,        <span class="co"># Y-axis label</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="dt">xlab=</span><span class="st">&#39;Treatment group&#39;</span>, <span class="co"># X-axis label</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="dt">boxwex=</span>.<span class="dv">25</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  )</span></code></pre></div>
<p><img src="05_linearModels_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>In addition to what we wrote before, we can now say something along the lines of:</p>
<blockquote>
<p>“We found that the mass of plants in the trt2 group (5.5 <span class="math inline">\(\pm\)</span> 0.4 g) was significantly greater than plants in the trt1 group (4.7 <span class="math inline">\(\pm\)</span> 0.8 g; Tukey HSD, p = 0.012). However, we failed to detect differences in mass between plants in the control group (5.0 <span class="math inline">\(\pm\)</span> 0.6 g) and trt1 (p = 0.39) or trt2 (p = 0.20).”</p>
</blockquote>
<div id="two-way-anova" class="section level3">
<h3>Two-way ANOVA</h3>
<p>Next, we’ll step up the complexity and talk about cases for which we have more than one grouping variable and some kind of numeric response. In these cases, we can use a two-way ANOVA (or ‘n-way’ depending on number of factors) to examine effects of more than one grouping variable on the response.</p>
<p>Here, we will use a dataset describing differences in the mass of belly- button lint collected from males and females of three species of apes.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Read in the data:</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>lint &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;lint.txt&#39;</span>)</span></code></pre></div>
<div id="main-effects-model" class="section level4">
<h4>Main effects model</h4>
<p>Now we can fit a model to the data. This will work the same way as for the one-way ANOVA above, but this time we will add more terms on the right hand side of the equation. We will start by looking at the <em>main effects</em> model for this dataset.</p>
<p>What is a main-effects model? This model assumes that the response of interest, in this case the mass of belly button lint, <code>lintmass</code>, is affected by both <code>species</code> and <code>gender</code>, and that within species the effect of gender is the same. For example, the mass of belly button lint could be greater in one species compared to others, and if there is a difference between sexes we would expect that trend to be the same across species (e.g., boys always have more lint than girls- sorry guys, it’s probably true!).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Fit the model and save it to an object</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>lint.model&lt;-<span class="st"> </span><span class="kw">lm</span>(lintmass<span class="op">~</span>species <span class="op">+</span><span class="st"> </span>gender, <span class="dt">data=</span>lint)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Look at the summary of the model fit</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">summary</span>(lint.model)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a>Call<span class="op">:</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">lm</span>(<span class="dt">formula =</span> lintmass <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>gender, <span class="dt">data =</span> lint)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a>Residuals<span class="op">:</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="st">    </span>Min      1Q  Median      3Q     Max </span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="fl">-2.5792</span> <span class="fl">-0.9021</span>  <span class="fl">0.0875</span>  <span class="fl">0.8448</span>  <span class="fl">2.3917</span> </span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a>Coefficients<span class="op">:</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="st">                 </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb9-16"><a href="#cb9-16"></a>(Intercept)       <span class="fl">15.5458</span>     <span class="fl">0.6133</span>  <span class="fl">25.346</span>  <span class="op">&lt;</span><span class="st"> </span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>speciesSpecies <span class="dv">2</span>  <span class="fl">-3.4375</span>     <span class="fl">0.7512</span>  <span class="fl">-4.576</span> <span class="fl">0.000183</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>speciesSpecies <span class="dv">3</span>  <span class="fl">-1.8750</span>     <span class="fl">0.7512</span>  <span class="fl">-2.496</span> <span class="fl">0.021414</span> <span class="op">*</span><span class="st">  </span></span>
<span id="cb9-19"><a href="#cb9-19"></a>genderMale         <span class="fl">4.9083</span>     <span class="fl">0.6133</span>   <span class="fl">8.003</span> <span class="fl">1.16e-07</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="op">---</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb9-22"><a href="#cb9-22"></a></span>
<span id="cb9-23"><a href="#cb9-23"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">1.502</span> on <span class="dv">20</span> degrees of freedom</span>
<span id="cb9-24"><a href="#cb9-24"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.8096</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.781</span> </span>
<span id="cb9-25"><a href="#cb9-25"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">28.35</span> on <span class="dv">3</span> and <span class="dv">20</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">2.107e-07</span></span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co"># Print the anova table</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="kw">anova</span>(lint.model)</span>
<span id="cb9-29"><a href="#cb9-29"></a>Analysis of Variance Table</span>
<span id="cb9-30"><a href="#cb9-30"></a></span>
<span id="cb9-31"><a href="#cb9-31"></a>Response<span class="op">:</span><span class="st"> </span>lintmass</span>
<span id="cb9-32"><a href="#cb9-32"></a>          Df  Sum Sq Mean Sq F value    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb9-33"><a href="#cb9-33"></a>species    <span class="dv">2</span>  <span class="fl">47.396</span>  <span class="fl">23.698</span>  <span class="fl">10.499</span> <span class="fl">0.0007633</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb9-34"><a href="#cb9-34"></a>gender     <span class="dv">1</span> <span class="fl">144.550</span> <span class="fl">144.550</span>  <span class="fl">64.041</span>  <span class="fl">1.16e-07</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>Residuals <span class="dv">20</span>  <span class="fl">45.143</span>   <span class="fl">2.257</span>                      </span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="op">---</span></span>
<span id="cb9-37"><a href="#cb9-37"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>As you can see, the output for the model is much the same as for the one- way ANOVA. The only real difference is that we have more than one grouping variable here.</p>
<p>We could look at the data all at once, but this gets a bit messy:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Make the boxplot to start with</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">boxplot</span>(<span class="dt">formula=</span>lintmass<span class="op">~</span>species<span class="op">+</span>gender, <span class="co"># Formula</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>        <span class="dt">data=</span>lint,                       <span class="co"># The data set</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>        <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,                      <span class="co"># Color for box fill</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>        <span class="dt">ylab=</span><span class="st">&#39;Mass (g)&#39;</span>,                 <span class="co"># Label for y-axis</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>        <span class="dt">names=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;Species 1&#39;</span>, <span class="st">&#39;Species 2&#39;</span>, <span class="st">&#39;Species 3&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb10-7"><a href="#cb10-7"></a>        <span class="dt">boxwex=</span>.<span class="dv">25</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>        )</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># Add a vertical line to separate sexes</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="fl">3.5</span>, <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co"># Label sexes at the top of the plot</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="kw">mtext</span>(<span class="dt">text=</span><span class="st">&#39;Female&#39;</span>, <span class="dt">side=</span><span class="dv">3</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">2</span>))</span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="kw">mtext</span>(<span class="dt">text=</span><span class="st">&#39;Male&#39;</span>, <span class="dt">side=</span><span class="dv">3</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">5</span>))</span></code></pre></div>
<p><img src="05_linearModels_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We can also look at the factors seperately:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Set the plotting window so it can</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># fit two boxplots side by side</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># Add the first boxplot to the plotting window</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">boxplot</span>(<span class="dt">formula=</span>lintmass<span class="op">~</span>species,</span>
<span id="cb11-7"><a href="#cb11-7"></a>        <span class="dt">data=</span>lint,</span>
<span id="cb11-8"><a href="#cb11-8"></a>        <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,</span>
<span id="cb11-9"><a href="#cb11-9"></a>        <span class="dt">ylab=</span><span class="st">&#39;Mass (g)&#39;</span>,</span>
<span id="cb11-10"><a href="#cb11-10"></a>        <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&#39;Sp. 1&#39;</span>, <span class="st">&#39;Sp. 2&#39;</span>, <span class="st">&#39;Sp. 3&#39;</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>        )</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co"># Add the second boxplot</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="kw">boxplot</span>(lintmass<span class="op">~</span>gender,</span>
<span id="cb11-15"><a href="#cb11-15"></a>        <span class="dt">data=</span>lint,</span>
<span id="cb11-16"><a href="#cb11-16"></a>        <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>        <span class="dt">ylab=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb11-18"><a href="#cb11-18"></a>        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&#39;Female&#39;</span>, <span class="st">&#39;Male&#39;</span>)</span>
<span id="cb11-19"><a href="#cb11-19"></a>        )</span></code></pre></div>
<p><img src="05_linearModels_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Hopefully after seeing these results you are now starting to realize how important a few well-placed figures and tables can be for clearly communicating the results of your research (even if it is about belly-button lint).</p>
</div>
<div id="interaction-terms" class="section level4">
<h4>Interaction terms</h4>
<p>The n-way ANOVA is the first kind of model we have used in which it is possible to consider <em>interactions</em> between two factors. An interaction is a situation that occurs when the effects of two or more factors is not additive. This means that the effect of gender might change for different species. For example, let us consider the following scenario in the lint data.</p>
<p>Perhaps we hypothesize that lint accumulation in the belly buttons of females differs in pattern from males due to social grooming patterns and sex-specific behavioral patterns favoring females. As a result, we might expect that sex and species could have some kind of non-additive effect on lint mass in these apes. To test this, we would use the following:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Fit a new model that includes an interaction, signified by &#39;*&#39;</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>lint.modeli &lt;-<span class="st"> </span><span class="kw">lm</span>(lintmass<span class="op">~</span>species <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data=</span>lint)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># Summarize the model</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">summary</span>(lint.modeli)</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a>Call<span class="op">:</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">lm</span>(<span class="dt">formula =</span> lintmass <span class="op">~</span><span class="st"> </span>species <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data =</span> lint)</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a>Residuals<span class="op">:</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="st">   </span>Min     1Q Median     3Q    Max </span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="fl">-2.525</span> <span class="fl">-0.750</span>  <span class="fl">0.050</span>  <span class="fl">1.019</span>  <span class="fl">1.875</span> </span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a>Coefficients<span class="op">:</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="st">                            </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb12-16"><a href="#cb12-16"></a>(Intercept)                  <span class="fl">14.9250</span>     <span class="fl">0.7404</span>  <span class="fl">20.159</span> <span class="fl">8.40e-14</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>speciesSpecies <span class="dv">2</span>             <span class="fl">-2.2500</span>     <span class="fl">1.0471</span>  <span class="fl">-2.149</span>   <span class="fl">0.0455</span> <span class="op">*</span><span class="st">  </span></span>
<span id="cb12-18"><a href="#cb12-18"></a>speciesSpecies <span class="dv">3</span>             <span class="fl">-1.2000</span>     <span class="fl">1.0471</span>  <span class="fl">-1.146</span>   <span class="fl">0.2668</span>    </span>
<span id="cb12-19"><a href="#cb12-19"></a>genderMale                    <span class="fl">6.1500</span>     <span class="fl">1.0471</span>   <span class="fl">5.874</span> <span class="fl">1.46e-05</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb12-20"><a href="#cb12-20"></a>speciesSpecies <span class="dv">2</span><span class="op">:</span>genderMale  <span class="fl">-2.3750</span>     <span class="fl">1.4808</span>  <span class="fl">-1.604</span>   <span class="fl">0.1261</span>    </span>
<span id="cb12-21"><a href="#cb12-21"></a>speciesSpecies <span class="dv">3</span><span class="op">:</span>genderMale  <span class="fl">-1.3500</span>     <span class="fl">1.4808</span>  <span class="fl">-0.912</span>   <span class="fl">0.3740</span>    </span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="op">---</span></span>
<span id="cb12-23"><a href="#cb12-23"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb12-24"><a href="#cb12-24"></a></span>
<span id="cb12-25"><a href="#cb12-25"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">1.481</span> on <span class="dv">18</span> degrees of freedom</span>
<span id="cb12-26"><a href="#cb12-26"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.8335</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.7873</span> </span>
<span id="cb12-27"><a href="#cb12-27"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">18.03</span> on <span class="dv">5</span> and <span class="dv">18</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">1.898e-06</span></span>
<span id="cb12-28"><a href="#cb12-28"></a></span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="co"># Print an ANOVA table for the model</span></span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="kw">anova</span>(lint.modeli)</span>
<span id="cb12-31"><a href="#cb12-31"></a>Analysis of Variance Table</span>
<span id="cb12-32"><a href="#cb12-32"></a></span>
<span id="cb12-33"><a href="#cb12-33"></a>Response<span class="op">:</span><span class="st"> </span>lintmass</span>
<span id="cb12-34"><a href="#cb12-34"></a>               Df  Sum Sq Mean Sq F value    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb12-35"><a href="#cb12-35"></a>species         <span class="dv">2</span>  <span class="fl">47.396</span>  <span class="fl">23.698</span> <span class="fl">10.8079</span> <span class="fl">0.0008253</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb12-36"><a href="#cb12-36"></a>gender          <span class="dv">1</span> <span class="fl">144.550</span> <span class="fl">144.550</span> <span class="fl">65.9253</span> <span class="fl">1.983e-07</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb12-37"><a href="#cb12-37"></a>species<span class="op">:</span>gender  <span class="dv">2</span>   <span class="fl">5.676</span>   <span class="fl">2.838</span>  <span class="fl">1.2943</span> <span class="fl">0.2984104</span>    </span>
<span id="cb12-38"><a href="#cb12-38"></a>Residuals      <span class="dv">18</span>  <span class="fl">39.468</span>   <span class="fl">2.193</span>                      </span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="op">---</span></span>
<span id="cb12-40"><a href="#cb12-40"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>Alas, in the case of the lint model, this interaction is not significant, so we the evidence we would need to say that lint accumulation changes differently between sexes within species.</p>
<p>Note that the n-way ANOVA is also the framework within which the randomized block design is implemented. We will not cover that in this course as the implementation is identical to that above, but with more attention to how sampling units are determined within larger grouping schemes (e.g., plots within stands).</p>
</div>
</div>
</div>
<div id="non-parametric-anova-kruskal-wallis" class="section level2">
<h2>Non-parametric “ANOVA”: Kruskal-Wallis</h2>
<p>We will give the non-parametric Kruskal-Wallis test a brief treatment here. The main reason that the treatment will be brief is that we will cover a wide variety of methods from now until the end of this course that will all but eliminate the need for this technique in your tool box. However, some of you will inevitably have some need for this (probably because the edict has been passed down to you from a superior who doesn’t ‘get’ GLM or because sample sizes are limiting).</p>
<p>We will use the <code>airquality</code> data for this example</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Load the data set</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">data</span>(<span class="st">&quot;airquality&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># Now test for test for differences</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># in Ozone levels between months in the</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># data set.</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>air.test&lt;-<span class="st"> </span><span class="kw">kruskal.test</span>(Ozone <span class="op">~</span><span class="st"> </span>Month, <span class="dt">data =</span> airquality)</span>
<span id="cb13-8"><a href="#cb13-8"></a>air.test</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>    Kruskal<span class="op">-</span>Wallis rank sum test</span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a>data<span class="op">:</span><span class="st">  </span>Ozone by Month</span>
<span id="cb13-13"><a href="#cb13-13"></a>Kruskal<span class="op">-</span>Wallis chi<span class="op">-</span>squared =<span class="st"> </span><span class="fl">29.267</span>, df =<span class="st"> </span><span class="dv">4</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">6.901e-06</span></span></code></pre></div>
<p>We find that there are signigicant shifts in median <code>Ozone</code> between <code>months</code>. Hopefully, it is now obvious that we can use a boxplot to visualize these differences.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">boxplot</span>(Ozone <span class="op">~</span><span class="st"> </span>Month,</span>
<span id="cb14-2"><a href="#cb14-2"></a>        <span class="dt">data =</span> airquality,</span>
<span id="cb14-3"><a href="#cb14-3"></a>        <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>        <span class="dt">ylab=</span><span class="st">&#39;Ozone&#39;</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>        <span class="dt">xlab =</span> <span class="st">&#39;Month&#39;</span>)</span></code></pre></div>
<p><img src="05_linearModels_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>As far as the utility of Kruskal-Wallis goes, this is about it without getting into gross complexities that, in and of themselves, warrant an alternative approach. The alternative approach will be the focus of much discussion for the rest of the semester.</p>
</div>
<div id="linear-regression" class="section level2">
<h2>Linear regression</h2>
<p>We have now considered the case of what to do when we have a numerical response and categorical explanatory variable(s). But, what if we have both a numerical response and numerical explanatory variables? Fear not, there is a stat for that! Now we are entering the realm of correlation and regression.</p>
<p>When we fit a linear regression model, we are trying to explain relationships between some response of interest (dependent variable) and one or more explanatory (independent) variables.</p>
<p>As with all linear models the goal of regression analysis is, in it’s simplest sense, to fit a line through all of the points in bivariate space that minimizes the distance between the points and a line of the form:</p>
<p><span class="math display">\[y = mx + b\]</span></p>
<p>or more appropriately in the case of statistics:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_i X_i\]</span></p>
<p>We will discuss this and other ideas related to linear models in class. For the casual reader, we are ignoring an important part of these statistical models for now. In most cases, though, we will be estimating a parameter for the intercept and one parameter for each explanatory variable of interest.</p>
<blockquote>
<p>Data!</p>
</blockquote>
<p>These data are for fertility and infant mortality rates as related to a number of socio-economic indicators. Take a moment to look at them:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">data</span>(swiss)</span>
<span id="cb15-2"><a href="#cb15-2"></a>?swiss</span></code></pre></div>
<p>Now, let’s get cracking.</p>
<p>We’ll start by fitting a simple model and then build complexity.</p>
<p>Fit a model that relates fertility to education level. Notice that this looks exactly the same as the call to <code>lm</code> for the ANOVAs above? That’s because they are the same thing and people have been lying to you your whole life!!!</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Fit the model and assign it to a named object</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>fert.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Fertility<span class="op">~</span>Education, <span class="dt">data =</span> swiss)</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Summarize the model</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="kw">summary</span>(fert.mod)</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a>Call<span class="op">:</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="kw">lm</span>(<span class="dt">formula =</span> Fertility <span class="op">~</span><span class="st"> </span>Education, <span class="dt">data =</span> swiss)</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a>Residuals<span class="op">:</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="st">    </span>Min      1Q  Median      3Q     Max </span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="fl">-17.036</span>  <span class="fl">-6.711</span>  <span class="fl">-1.011</span>   <span class="fl">9.526</span>  <span class="fl">19.689</span> </span>
<span id="cb16-13"><a href="#cb16-13"></a></span>
<span id="cb16-14"><a href="#cb16-14"></a>Coefficients<span class="op">:</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="st">            </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb16-16"><a href="#cb16-16"></a>(Intercept)  <span class="fl">79.6101</span>     <span class="fl">2.1041</span>  <span class="fl">37.836</span>  <span class="op">&lt;</span><span class="st"> </span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>Education    <span class="fl">-0.8624</span>     <span class="fl">0.1448</span>  <span class="fl">-5.954</span> <span class="fl">3.66e-07</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="op">---</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb16-20"><a href="#cb16-20"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">9.446</span> on <span class="dv">45</span> degrees of freedom</span>
<span id="cb16-22"><a href="#cb16-22"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4406</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.4282</span> </span>
<span id="cb16-23"><a href="#cb16-23"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">35.45</span> on <span class="dv">1</span> and <span class="dv">45</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">3.659e-07</span></span></code></pre></div>
<p>We see that there is a significant “negative” or “inverse” relation between <code>Education</code> level and <code>fertility</code>. In other words, more highly educated individuals have fewer children. You can tell this is an inverse relationship because of the minus sign in front of the coefficient. We know that the relationship is significant because of the small p-value and corresponding significance codes.</p>
<p>We can also see that we have explained a little more than 40% of the variability in the response with this one explanatory variable if we look at the <span class="math inline">\(R^2\)</span> value that is returned.</p>
<p>This is as far as the summary goes for linear regression for now. That is, we don’t need the ANOVA table any more because we have no factors- just continuous variables. What we end up with in this summary are the coefficients (corresponding to parameters of a model) that can be used to describe the line that passes through the data and minimizes the residual errors (thats the part we left out above).</p>
<blockquote>
<p>WHAT??</p>
</blockquote>
<p>Let’s explain this by actually looking at the data:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># First make a sequence of new values for</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># Education across observed range</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Education=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">55</span>,.<span class="dv">1</span>))</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co"># Plot the raw data</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="kw">plot</span>(<span class="dt">x=</span>swiss<span class="op">$</span>Education,</span>
<span id="cb17-8"><a href="#cb17-8"></a>       swiss<span class="op">$</span>Fertility,</span>
<span id="cb17-9"><a href="#cb17-9"></a>       <span class="dt">ylab=</span><span class="st">&#39;Fertility&#39;</span>,</span>
<span id="cb17-10"><a href="#cb17-10"></a>       <span class="dt">xlab=</span><span class="st">&#39;Education&#39;</span>,</span>
<span id="cb17-11"><a href="#cb17-11"></a>       <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&#39;gray&#39;</span>,</span>
<span id="cb17-12"><a href="#cb17-12"></a>       <span class="dt">cex=</span><span class="fl">1.5</span>,</span>
<span id="cb17-13"><a href="#cb17-13"></a>       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">100</span>)</span>
<span id="cb17-14"><a href="#cb17-14"></a>       )</span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co"># Now, we will add a trendline</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>  preds =<span class="st"> </span><span class="kw">predict</span>(fert.mod, <span class="dt">newdata=</span>new,</span>
<span id="cb17-17"><a href="#cb17-17"></a>    <span class="dt">interval =</span> <span class="st">&#39;prediction&#39;</span>)</span>
<span id="cb17-18"><a href="#cb17-18"></a>  <span class="kw">lines</span>(new[,<span class="dv">1</span>], preds[,<span class="dv">1</span>], <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-19"><a href="#cb17-19"></a>  <span class="kw">lines</span>(new[,<span class="dv">1</span>], preds[,<span class="dv">3</span>], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb17-20"><a href="#cb17-20"></a>  <span class="kw">lines</span>(new[,<span class="dv">1</span>], preds[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="05_linearModels_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>We can, of course, extend this to include multiple continuous explanatory variables of interest.</p>
<p><strong>Example:</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Effects of Education and % Catholic on fertility</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>multiple.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Fertility<span class="op">~</span>Education<span class="op">+</span>Catholic, <span class="dt">data=</span>swiss)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw">summary</span>(multiple.mod)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a>Call<span class="op">:</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">lm</span>(<span class="dt">formula =</span> Fertility <span class="op">~</span><span class="st"> </span>Education <span class="op">+</span><span class="st"> </span>Catholic, <span class="dt">data =</span> swiss)</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a>Residuals<span class="op">:</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">    </span>Min      1Q  Median      3Q     Max </span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="fl">-15.042</span>  <span class="fl">-6.578</span>  <span class="fl">-1.431</span>   <span class="fl">6.122</span>  <span class="fl">14.322</span> </span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a>Coefficients<span class="op">:</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="st">            </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb18-15"><a href="#cb18-15"></a>(Intercept) <span class="fl">74.23369</span>    <span class="fl">2.35197</span>  <span class="fl">31.562</span>  <span class="op">&lt;</span><span class="st"> </span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>Education   <span class="fl">-0.78833</span>    <span class="fl">0.12929</span>  <span class="fl">-6.097</span> <span class="fl">2.43e-07</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>Catholic     <span class="fl">0.11092</span>    <span class="fl">0.02981</span>   <span class="fl">3.721</span>  <span class="fl">0.00056</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="op">---</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb18-20"><a href="#cb18-20"></a></span>
<span id="cb18-21"><a href="#cb18-21"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">8.331</span> on <span class="dv">44</span> degrees of freedom</span>
<span id="cb18-22"><a href="#cb18-22"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5745</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.5552</span> </span>
<span id="cb18-23"><a href="#cb18-23"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st">  </span><span class="fl">29.7</span> on <span class="dv">2</span> and <span class="dv">44</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">6.849e-09</span></span>
<span id="cb18-24"><a href="#cb18-24"></a></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="co"># Or if we want to get really crazy:</span></span>
<span id="cb18-26"><a href="#cb18-26"></a>full.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Fertility<span class="op">~</span>Agriculture<span class="op">+</span>Examination<span class="op">+</span>Education<span class="op">+</span>Catholic,</span>
<span id="cb18-27"><a href="#cb18-27"></a>  <span class="dt">data=</span>swiss)</span>
<span id="cb18-28"><a href="#cb18-28"></a></span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="kw">summary</span>(full.mod)</span>
<span id="cb18-30"><a href="#cb18-30"></a></span>
<span id="cb18-31"><a href="#cb18-31"></a>Call<span class="op">:</span></span>
<span id="cb18-32"><a href="#cb18-32"></a><span class="kw">lm</span>(<span class="dt">formula =</span> Fertility <span class="op">~</span><span class="st"> </span>Agriculture <span class="op">+</span><span class="st"> </span>Examination <span class="op">+</span><span class="st"> </span>Education <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-33"><a href="#cb18-33"></a><span class="st">    </span>Catholic, <span class="dt">data =</span> swiss)</span>
<span id="cb18-34"><a href="#cb18-34"></a></span>
<span id="cb18-35"><a href="#cb18-35"></a>Residuals<span class="op">:</span></span>
<span id="cb18-36"><a href="#cb18-36"></a><span class="st">     </span>Min       1Q   Median       3Q      Max </span>
<span id="cb18-37"><a href="#cb18-37"></a><span class="fl">-15.7813</span>  <span class="fl">-6.3308</span>   <span class="fl">0.8113</span>   <span class="fl">5.7205</span>  <span class="fl">15.5569</span> </span>
<span id="cb18-38"><a href="#cb18-38"></a></span>
<span id="cb18-39"><a href="#cb18-39"></a>Coefficients<span class="op">:</span></span>
<span id="cb18-40"><a href="#cb18-40"></a><span class="st">            </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb18-41"><a href="#cb18-41"></a>(Intercept) <span class="fl">91.05542</span>    <span class="fl">6.94881</span>  <span class="fl">13.104</span>  <span class="op">&lt;</span><span class="st"> </span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb18-42"><a href="#cb18-42"></a>Agriculture <span class="fl">-0.22065</span>    <span class="fl">0.07360</span>  <span class="fl">-2.998</span>  <span class="fl">0.00455</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb18-43"><a href="#cb18-43"></a>Examination <span class="fl">-0.26058</span>    <span class="fl">0.27411</span>  <span class="fl">-0.951</span>  <span class="fl">0.34722</span>    </span>
<span id="cb18-44"><a href="#cb18-44"></a>Education   <span class="fl">-0.96161</span>    <span class="fl">0.19455</span>  <span class="fl">-4.943</span> <span class="fl">1.28e-05</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb18-45"><a href="#cb18-45"></a>Catholic     <span class="fl">0.12442</span>    <span class="fl">0.03727</span>   <span class="fl">3.339</span>  <span class="fl">0.00177</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb18-46"><a href="#cb18-46"></a><span class="op">---</span></span>
<span id="cb18-47"><a href="#cb18-47"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb18-48"><a href="#cb18-48"></a></span>
<span id="cb18-49"><a href="#cb18-49"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">7.736</span> on <span class="dv">42</span> degrees of freedom</span>
<span id="cb18-50"><a href="#cb18-50"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.6498</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.6164</span> </span>
<span id="cb18-51"><a href="#cb18-51"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st"> </span><span class="fl">19.48</span> on <span class="dv">4</span> and <span class="dv">42</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="fl">3.95e-09</span></span></code></pre></div>
<p>During the next couple of weeks, we’ll try to figure out a way to deal with this rat’s nest of different explanatory variables.</p>
</div>
<div id="analysis-of-covariance-ancova" class="section level2">
<h2>Analysis of covariance (ANCOVA)</h2>
<p>Alright, to wrap up this crazy, eye-opening week we are going to unleash the power of ANCOVA. Hopefully the power and limitations of this approach will be readily apparent to you. If not, we will talk about them to finish anyway so don’t worry.</p>
<p>ANCOVA is the way into the world of real, complex data analyses. It will serve as the foundation for the next several weeks in this course. Get to know it well, it is your friend.</p>
<p>So here we are:</p>
<p>We are in the real world and we have multiple explanatory variables that we would like to test; some are factors and some are continuous. We want a nice elegant way of wrapping these all in to one analysis. How? It’s easier than you might think…</p>
<p>Read in a new data set.</p>
<p>This data set contains pulses of two species of crickets collected under varying temperatures.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Read in the cricket data and assign it to a named object</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>crickets &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;crickets.txt&#39;</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># Have a look</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="kw">head</span>(crickets)</span></code></pre></div>
<pre><code>  Species Temp Pulse
1      ex 20.8  67.9
2      ex 20.8  65.1
3      ex 24.0  77.3
4      ex 24.0  78.7
5      ex 24.0  79.4
6      ex 24.0  80.4</code></pre>
<p>Here we want to investigate the effects of species and temperature on pulses of individual crickets.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Fit the model</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  cricket.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Pulse<span class="op">~</span>Species <span class="op">+</span><span class="st"> </span>Temp, <span class="dt">data=</span>crickets)</span></code></pre></div>
<p>Install the car package. We need a function from this library for summary.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Uncomment front of line to install</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co"># install.packages(&#39;car&#39;) </span></span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># Load the package</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="kw">library</span>(car)</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co"># Now we create the anova table</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co"># for our ancova model</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="kw">Anova</span>(cricket.mod, <span class="dt">type=</span><span class="st">&#39;III&#39;</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a>Anova <span class="kw">Table</span> (Type III tests)</span>
<span id="cb22-11"><a href="#cb22-11"></a></span>
<span id="cb22-12"><a href="#cb22-12"></a>Response<span class="op">:</span><span class="st"> </span>Pulse</span>
<span id="cb22-13"><a href="#cb22-13"></a>            Sum Sq Df   F value    <span class="kw">Pr</span>(<span class="op">&gt;</span>F)    </span>
<span id="cb22-14"><a href="#cb22-14"></a>(Intercept)   <span class="fl">25.5</span>  <span class="dv">1</span>    <span class="fl">7.9906</span>  <span class="fl">0.008582</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb22-15"><a href="#cb22-15"></a>Species      <span class="fl">598.0</span>  <span class="dv">1</span>  <span class="fl">187.3994</span> <span class="fl">6.272e-14</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>Temp        <span class="fl">4376.1</span>  <span class="dv">1</span> <span class="fl">1371.3541</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>Residuals     <span class="fl">89.3</span> <span class="dv">28</span>                        </span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="op">---</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb22-20"><a href="#cb22-20"></a></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="co"># And we can look at the</span></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="co"># summary of the linear model</span></span>
<span id="cb22-23"><a href="#cb22-23"></a><span class="kw">summary</span>(cricket.mod)</span>
<span id="cb22-24"><a href="#cb22-24"></a></span>
<span id="cb22-25"><a href="#cb22-25"></a>Call<span class="op">:</span></span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="kw">lm</span>(<span class="dt">formula =</span> Pulse <span class="op">~</span><span class="st"> </span>Species <span class="op">+</span><span class="st"> </span>Temp, <span class="dt">data =</span> crickets)</span>
<span id="cb22-27"><a href="#cb22-27"></a></span>
<span id="cb22-28"><a href="#cb22-28"></a>Residuals<span class="op">:</span></span>
<span id="cb22-29"><a href="#cb22-29"></a><span class="st">    </span>Min      1Q  Median      3Q     Max </span>
<span id="cb22-30"><a href="#cb22-30"></a><span class="fl">-3.0128</span> <span class="fl">-1.1296</span> <span class="fl">-0.3912</span>  <span class="fl">0.9650</span>  <span class="fl">3.7800</span> </span>
<span id="cb22-31"><a href="#cb22-31"></a></span>
<span id="cb22-32"><a href="#cb22-32"></a>Coefficients<span class="op">:</span></span>
<span id="cb22-33"><a href="#cb22-33"></a><span class="st">             </span>Estimate Std. Error t value <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>t<span class="op">|</span>)    </span>
<span id="cb22-34"><a href="#cb22-34"></a>(Intercept)  <span class="fl">-7.21091</span>    <span class="fl">2.55094</span>  <span class="fl">-2.827</span>  <span class="fl">0.00858</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb22-35"><a href="#cb22-35"></a>Speciesniv  <span class="fl">-10.06529</span>    <span class="fl">0.73526</span> <span class="fl">-13.689</span> <span class="fl">6.27e-14</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb22-36"><a href="#cb22-36"></a>Temp          <span class="fl">3.60275</span>    <span class="fl">0.09729</span>  <span class="fl">37.032</span>  <span class="op">&lt;</span><span class="st"> </span><span class="fl">2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb22-37"><a href="#cb22-37"></a><span class="op">---</span></span>
<span id="cb22-38"><a href="#cb22-38"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb22-39"><a href="#cb22-39"></a></span>
<span id="cb22-40"><a href="#cb22-40"></a>Residual standard error<span class="op">:</span><span class="st"> </span><span class="fl">1.786</span> on <span class="dv">28</span> degrees of freedom</span>
<span id="cb22-41"><a href="#cb22-41"></a>Multiple R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.9896</span>,    Adjusted R<span class="op">-</span>squared<span class="op">:</span><span class="st">  </span><span class="fl">0.9888</span> </span>
<span id="cb22-42"><a href="#cb22-42"></a>F<span class="op">-</span>statistic<span class="op">:</span><span class="st">  </span><span class="dv">1331</span> on <span class="dv">2</span> and <span class="dv">28</span> DF,  p<span class="op">-</span>value<span class="op">:</span><span class="st"> </span><span class="er">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span></span></code></pre></div>
<p>We see that there are significant effects of species and temperature on the pulse of individual crickets. Everything else proceeds as above! We can build in complexity as needed, and we can make predictions as above.</p>
<div id="making-and-plotting-model-predictions" class="section level3">
<h3>Making and plotting model predictions</h3>
<p>Here we will take a quick look at how to plot model predictions over our raw data to demonstrate the relationships we have discovered and to show how they compare to our observations.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># Plot the raw data</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">plot</span>(crickets<span class="op">$</span>Temp,</span>
<span id="cb23-3"><a href="#cb23-3"></a>  crickets<span class="op">$</span>Pulse,</span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="dt">pch=</span><span class="dv">21</span>,</span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="dt">bg=</span><span class="kw">c</span>(<span class="st">&#39;gray&#39;</span>, <span class="st">&#39;black&#39;</span>)[crickets<span class="op">$</span>Species],</span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="dt">cex=</span><span class="fl">1.5</span>,</span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="dt">ylab =</span> <span class="st">&#39;Pulse&#39;</span>,</span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&#39;Temperature (&#39;</span>, degree, <span class="st">&#39;C)&#39;</span>)),</span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="dt">yaxt =</span> <span class="st">&#39;n&#39;</span>)</span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co"># Add the y-axis labels and rotate them</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">las=</span><span class="dv">2</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co"># Make predictions from the fitted model object</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>preds &lt;-<span class="st"> </span>(<span class="kw">predict.lm</span>(cricket.mod,</span>
<span id="cb23-15"><a href="#cb23-15"></a>                     <span class="dt">newdata =</span> crickets,</span>
<span id="cb23-16"><a href="#cb23-16"></a>                     <span class="dt">interval =</span> <span class="st">&#39;prediction&#39;</span>))</span>
<span id="cb23-17"><a href="#cb23-17"></a></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="co"># Plot the predictions</span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co"># Add prediction lines for species &#39;ex&#39;</span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co"># Mean</span></span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="kw">lines</span>(crickets<span class="op">$</span>Temp[crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;ex&#39;</span>],</span>
<span id="cb23-22"><a href="#cb23-22"></a>  preds[,<span class="dv">1</span>][crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;ex&#39;</span>], <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>, <span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co"># Lower</span></span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="kw">lines</span>(crickets<span class="op">$</span>Temp[crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;ex&#39;</span>],</span>
<span id="cb23-25"><a href="#cb23-25"></a>  preds[,<span class="dv">2</span>][crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;ex&#39;</span>], <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="co"># Upper</span></span>
<span id="cb23-27"><a href="#cb23-27"></a><span class="kw">lines</span>(crickets<span class="op">$</span>Temp[crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;ex&#39;</span>],</span>
<span id="cb23-28"><a href="#cb23-28"></a>  preds[,<span class="dv">3</span>][crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;ex&#39;</span>], <span class="dt">col=</span><span class="st">&#39;gray&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb23-29"><a href="#cb23-29"></a></span>
<span id="cb23-30"><a href="#cb23-30"></a><span class="co"># Add prediction lines for species &#39;niv&#39;</span></span>
<span id="cb23-31"><a href="#cb23-31"></a><span class="co"># Mean</span></span>
<span id="cb23-32"><a href="#cb23-32"></a><span class="kw">lines</span>(crickets<span class="op">$</span>Temp[crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;niv&#39;</span>],</span>
<span id="cb23-33"><a href="#cb23-33"></a>  preds[,<span class="dv">1</span>][crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;niv&#39;</span>], <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb23-34"><a href="#cb23-34"></a><span class="co"># Lower</span></span>
<span id="cb23-35"><a href="#cb23-35"></a><span class="kw">lines</span>(crickets<span class="op">$</span>Temp[crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;niv&#39;</span>],</span>
<span id="cb23-36"><a href="#cb23-36"></a>  preds[,<span class="dv">2</span>][crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;niv&#39;</span>], <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb23-37"><a href="#cb23-37"></a><span class="co"># Upper</span></span>
<span id="cb23-38"><a href="#cb23-38"></a><span class="kw">lines</span>(crickets<span class="op">$</span>Temp[crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;niv&#39;</span>],</span>
<span id="cb23-39"><a href="#cb23-39"></a>  preds[,<span class="dv">3</span>][crickets<span class="op">$</span>Species<span class="op">==</span><span class="st">&#39;niv&#39;</span>], <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="05_linearModels_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="assumptions-of-general-linear-models" class="section level2">
<h2>Assumptions of general linear models</h2>
<p>Now that you hold real power in your hands to do data analysis, we need to to have our first talk about due diligence and assumptions of the statistical models that we use.</p>
<p>There are three fundamental assumptions that we either need to validate or address through experimental design in this class of models.</p>
<ol style="list-style-type: decimal">
<li>Independence of observations.</li>
<li>Normality of residuals (with mean=0 and sd=1)</li>
<li>Homogeneity of variances (i.e. homoscedasticity)</li>
</ol>
<p>We will discuss what each of these means in class next week, and during the next several weeks we will discuss methods for verifying these assumptions or relaxing the assumptions to meet our needs through specific techniques.</p>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
