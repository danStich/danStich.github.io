<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">danStich</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../../index.html">Home</a>
</li>
<li>
  <a href="../../teaching.html">Teaching</a>
</li>
<li>
  <a href="../../research.html">Research</a>
</li>
<li>
  <a href="../../cv.html">Curriculum vitae</a>
</li>
<li>
  <a href="../../courseWebsites.html">Course websites</a>
</li>
<li>
  <a href="../../contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}

.column {
    float: left;
    padding: 15px;
}

.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

.content {
    width: 75%;
}

</style>
<p><br></p>
<div id="intro-to-inferential-statistics" class="section level1">
<h1>Intro to inferential statistics</h1>
<p><br></p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The objective of this assignment is to help you formalize and test some simple hypotheses using basic statistical methods in R. This week we discussed basic inductive and deductive questions we can ask with null hypothesis significance testing and the strengths and weaknesses of this approach. In this assignment, we will attempt to demonstrate some of those ideas while you become familiar with univariate tests in R.</p>
<p>By the end of this lab, you should be able to: 1) formally state the null hypothesis that is being tested, as well as alternatives to the null; 2) conduct some basic statistical tests of those hypotheses; and 3) communicate the results of those tests with respect to the original hypothesis.</p>
<p><br></p>
</div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<p><br></p>
<div id="the-smolt-data" class="section level3">
<h3>The smolt data</h3>
<p><br></p>
<p>This week we are going to work with a new dataset, called <code>smolts</code>. These data come from a lab experiment that examined differences in physiology, behavior, and survival of endangered, juvenile Atlantic salmon (<em>Salmo salar</em>) from the largest remaining population in the United States.</p>
<p><br></p>
<p>The Atlantic salmon is an anadromous fish that spawns in fresh water and grows in the ocean. After they hatch from their eggs in fresh water, juvenile salmon spend about 2 years growing in streams until they grow large enough to make the migration to ocean feeding grounds off the west coast of Greenland. During the spring before they make this migration, the fish undergoes a transformation known as ‘smolting’, which involves a complex suite of physiological, morphological, and behavioral changes. Notably among these changes is the increased ability to osmoregulate in salt water. This ability is enhanced by upregulation and increased expression of gill Na+,K+-ATPase (NKA), an enzyme used in active transport of ions. The activity of nka increases seasonally from low levels early in the run, to high levels in the peak of the run, and eventually decreases late in the run due to warming temperatures. We can use gill NKA activity as an indicator of the physiological development of smolts to assess optimal stocking times.</p>
<p><br></p>
<p>This study compared physiological measurements of smolts throughout the course of the migratory window to their preferences for salt water in laboratory experiments, as well as plasma osmolality and survival following exposure to full sea water. We used a two-chamber tank that allowed us to keep salt water in one compartment and fresh water in the other and we tracked fish behavior in the tank using high-end infrared cameras and sophisticated tracking software.</p>
<blockquote>
<p>Let’s read in the data:</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in the data from comma-seperated text file</span>
  smolts =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;http://employees.oneonta.edu/stichds/data/smolts.txt&#39;</span>)
<span class="co"># Look at the first few rows of data</span>
  <span class="kw">head</span>(smolts)
##      ID     stage  fl  mass   nka osmolality      pref max n.switch
## 1 31B1F     Smolt 216  97.5 6.667        318 0.3638229  83       93
## 2 31B20     Smolt 184  63.0 4.444        306 0.3922490  47      107
## 3 31B27  Presmolt 183  61.1 1.429        418 0.3378025  45       80
## 4 31B29 Postsmolt 204  76.4 3.899        356 0.4551466  76      123
## 5 31B2A  Presmolt 218 117.0 3.623        419 0.4337464  62      107
## 6 31B2E Postsmolt 199  70.8 2.151        355 0.4828588  59      100
<span class="co"># Examine data structure  </span>
  <span class="kw">str</span>(smolts)
## &#39;data.frame&#39;:    169 obs. of  9 variables:
##  $ ID        : Factor w/ 169 levels &quot;31B1F&quot;,&quot;31B20&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ stage     : Factor w/ 3 levels &quot;Postsmolt&quot;,&quot;Presmolt&quot;,..: 3 3 2 1 2 1 1 1 1 2 ...
##  $ fl        : int  216 184 183 204 218 199 197 187 202 194 ...
##  $ mass      : num  97.5 63 61.1 76.4 117 70.8 80.1 64.6 76.4 65.3 ...
##  $ nka       : num  6.67 4.44 1.43 3.9 3.62 ...
##  $ osmolality: int  318 306 418 356 419 355 380 402 406 425 ...
##  $ pref      : num  0.364 0.392 0.338 0.455 0.434 ...
##  $ max       : int  83 47 45 76 62 59 83 112 54 38 ...
##  $ n.switch  : int  93 107 80 123 107 100 108 77 88 100 ...</code></pre></div>
<p><br></p>
<p>The dataset contains nine columns, with variables defined as:</p>
<p><br></p>
<pre><code>  1. ID: This is the last five digits of a hexidecimal PIT tag code.  
  2. stage: classification into presumed early (Presmolt), middle (Smolt), and 
     late (Postsmolt) parts of the run.  
  3. fl: the fork length of fish (mm)  
  4. mass: the mass of the fish (g)  
  5. nka: gill NKA activity for each fish prior to testing  
  6. osmolality: blood plasma osmolality following exposure to full sea water  
  7. pref: proportion of time spent in high salt water compartment of tank.  
  8. max: maximum continuous time spent in high salt water compartment tank.  
  9. n.switch: the number of times the fish moved between high salt water and 
     low salt water compartments of the behavior tank.    </code></pre>
<p><br></p>
</div>
<div id="one-sample-t-tests" class="section level3">
<h3>One sample t-tests</h3>
<p><br></p>
<p>Recall that with a one-sample t-test our objective is to determine whether or not a sample that we have taken deviates from the mean of a population of interest. We might be interested in this kind of question if we are trying to identify anomolous observations within a specific statistical or biological sample, or if we are trying to compare our data to literature values for which only a mean was reported. Remember that what we are doing statistically is to see whether or not the population mean is contained within the 95% confidence interval (CI) for the sampling distribution of our variable of interest.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, we&#39;ll make a couple of objects out of the data in the smolts dataframe</span>
  <span class="co"># Make a vector of smolt gill NKA activities</span>
    smolt.nka =<span class="st"> </span>smolts<span class="op">$</span>nka[smolts<span class="op">$</span>stage<span class="op">==</span><span class="st">&#39;Smolt&#39;</span>]
  <span class="co"># Quick summary of the data</span>
    <span class="kw">summary</span>(smolt.nka)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.531   4.346   5.577   5.551   6.886  10.543
  
  <span class="co"># Make a vector of presmolt gill NKA activity     </span>
    presmolt.nka =<span class="st"> </span>smolts<span class="op">$</span>nka[smolts<span class="op">$</span>stage<span class="op">==</span><span class="st">&#39;Presmolt&#39;</span>]
  <span class="co"># Another quick data summary</span>
    <span class="kw">summary</span>(presmolt.nka)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.378   2.406   3.111   3.146   3.631   7.779</code></pre></div>
<p><br></p>
<p>Now let’s use these data to work out a simple example. Your objective is to compare nka activity of the stage ‘Smolt’ to the sampling mean for gill NKA activity in the annual sampling distribution (4.16) using a one-sample t-test. You will need to choose an appropriate Type-I error rate (confidence level), and alternative hypothesis ahead of time in your analysis.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># If you have forgotten how to do this, you can look at your reference</span>
<span class="co"># script, or you can type:    </span>
?t.test</code></pre></div>
<p><br></p>
<p><em><strong>Question 1.</strong></em> First, formally state the null hypothesis for this test. Then, state the alternative hypothesis that you chose. If you want to use <code>greater</code> or <code>less</code> realize that this refers to the argument <code>x</code> in the <code>t.test</code> function as compared to <code>mu</code> or <code>y</code> (depending on whether it is a one or two sample test).</p>
<p><br></p>
<p>Now, run the test.</p>
<p><br></p>
<p><em><strong>Question 2.</strong></em> Does gill NKA activity of the stage ‘Smolt’ differ significantly from the population mean? Report:</p>
<p><br></p>
<ol style="list-style-type: lower-alpha">
<li><p>The t-statistic, degrees of freedom, and p-value for the test</p></li>
<li><p>The mean nka for the Smolt stage</p></li>
<li><p>The confidence interval for this mean and state the confidence level in your answer (will depend on your choice of confidence level above)</p></li>
</ol>
<p><br></p>
</div>
<div id="two-sample-t-test" class="section level3">
<h3>Two-sample t-test</h3>
<p><br></p>
<p>Now we will look at what you might think of as a more ‘standard’ application of the t-test. Here we are interested in comparing two sampling distributions from one or more biological populations to determine whether or not they come from the same statistical population. For this example:</p>
<p>First, test the assumptions of normality and equal variances.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># In case you forgot the functions:</span>
  ?shapiro.test <span class="co"># Shapiro-Wilk normality test</span>
  ?var.test     <span class="co"># Fisher&#39;s F test of equal variances</span></code></pre></div>
<p><br></p>
<p>We can also plot the distributions of gill NKA for the smolt and presmolt stages to see if they look normal.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">1</span>, <span class="dv">1</span>))
    <span class="kw">hist</span>(smolt.nka, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>),
      <span class="dt">main=</span><span class="st">&#39;&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;gill NKA&#39;</span>, <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>)
    <span class="kw">hist</span>(presmolt.nka, <span class="dt">col=</span><span class="kw">rgb</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.5</span>), <span class="dt">add=</span><span class="ot">TRUE</span>)
    <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">cex.axis=</span><span class="fl">1.15</span>)
    <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">1.15</span>)
    <span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">mean</span>(smolt.nka), <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
    <span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">mean</span>(presmolt.nka), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
    <span class="kw">text</span>(<span class="dt">x =</span> <span class="kw">mean</span>(smolt.nka), <span class="dt">y=</span><span class="dv">30</span>, <span class="kw">expression</span>(<span class="kw">paste</span>(mu[<span class="st">&#39;Smolt&#39;</span>])), <span class="dt">adj=</span><span class="op">-</span>.<span class="dv">25</span>,
        <span class="dt">cex=</span><span class="fl">1.25</span>)
    <span class="kw">text</span>(<span class="dt">x =</span> <span class="kw">mean</span>(presmolt.nka), <span class="dt">y=</span><span class="dv">30</span>, <span class="kw">expression</span>(<span class="kw">paste</span>(mu[<span class="st">&#39;Presmolt&#39;</span>])),
        <span class="dt">adj=</span><span class="fl">1.25</span>, <span class="dt">cex=</span><span class="fl">1.25</span>)
    <span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">10</span>, <span class="dt">y=</span><span class="dv">25</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;Smolt&#39;</span>, <span class="st">&#39;Presmolt&#39;</span>),
        <span class="dt">fill=</span><span class="kw">c</span>(<span class="st">&#39;gray40&#39;</span>, <span class="st">&#39;gray87&#39;</span>), <span class="dt">col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>)    </code></pre></div>
<p><img src="hw04_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><br></p>
<p><em><strong>Question 3.</strong></em> Are the sampling distributions for gill NKA activity of smolts and presmolts normal based on the results of the Shapiro-Wilk test and the histogram above? Are the variances equal based on the F test?</p>
<p><br></p>
<p>Conduct a two-sample t-test to compare gill NKA activities between <code>Smolt</code> and <code>Presmolt</code> stages.</p>
<p><br></p>
<p><em><strong>Question 4.</strong></em> State the null hypothesis for the test and the alternative hypothesis that you chose. Justify your choice of alternative.</p>
<p><br></p>
<p><em><strong>Question 5.</strong></em> Did you specify the <code>'var.equal'</code> argument? If so, what did you choose and what was the corresponding degrees of freedom?</p>
<p>If you did not specify this argument, note that R made a choice for you on the fly, and you can tell what that choice was by the df. We discussed the df for the t-test in class. In the case of the two-sample test, the df should be calculated as <span class="math inline">\((n_1-1)+(n_2-1)\)</span>, or 111 in this case, if the variances are equal. If you ran the <code>t.test</code> with this assumption, go back and run it the other way and look at the df:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Re-run the two-sample test</span>
  <span class="kw">t.test</span>(smolt.nka, presmolt.nka)    
## 
##  Welch Two Sample t-test
## 
## data:  smolt.nka and presmolt.nka
## t = 7.6894, df = 105.22, p-value = 8.247e-12
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  1.784862 3.025163
## sample estimates:
## mean of x mean of y 
##  5.551050  3.146038</code></pre></div>
<p><br></p>
<p>Weird, huh? How do you get a part of a degree of freedom?? And, it looks like we are short a few degrees of freedom, doesn’t it? So what’s happening here? We have to sacrifice a few extra degrees of freedom to stay conservative and avoid making a Type-I error. So, we need to base the df on the means and variances of the two sampling distributions. Check out the calculation on this <code>definitely not wrong and totally reliable</code> <a href="https://en.wikipedia.org/wiki/Welch%27s_t_test">Wikepedia page</a>:</p>
<p><br></p>
</div>
<div id="wilcoxon-test" class="section level3">
<h3>Wilcoxon test</h3>
<p><br></p>
<p>Moving on to the next variable…don’t worry, we will come back to the gill NKA data next week when we talk about ANOVA, because I know you are all dying to know about the postsmolt group.</p>
<p>Here, we will continue to look at the presmolt and smolt life stages. First, create two vectors: the first should hold all values of the variable ‘osmolality’ for presmolts, and the second should hold all values of the variable ‘osmolality’ for smolts.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># In case you have forgotten the data strucure already:</span>
  <span class="kw">str</span>(smolts)
## &#39;data.frame&#39;:    169 obs. of  9 variables:
##  $ ID        : Factor w/ 169 levels &quot;31B1F&quot;,&quot;31B20&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ stage     : Factor w/ 3 levels &quot;Postsmolt&quot;,&quot;Presmolt&quot;,..: 3 3 2 1 2 1 1 1 1 2 ...
##  $ fl        : int  216 184 183 204 218 199 197 187 202 194 ...
##  $ mass      : num  97.5 63 61.1 76.4 117 70.8 80.1 64.6 76.4 65.3 ...
##  $ nka       : num  6.67 4.44 1.43 3.9 3.62 ...
##  $ osmolality: int  318 306 418 356 419 355 380 402 406 425 ...
##  $ pref      : num  0.364 0.392 0.338 0.455 0.434 ...
##  $ max       : int  83 47 45 76 62 59 83 112 54 38 ...
##  $ n.switch  : int  93 107 80 123 107 100 108 77 88 100 ...</code></pre></div>
<p><br></p>
<p><em><strong>Question 6.</strong></em> Do these sampling distributions conform to the normal distribution? Why or why not (note that there are multiple reasons).</p>
<p><br></p>
<p>Plot a histogram of the distributions. Can’t remember how to do this?</p>
<p><img src="../../images/inTheLabDirections.png" alt=""></p>
<p><br></p>
<p>Okay, now that you have plotted an awesome histogram to check distributional assumptions, use a Wilcoxon test to determine whether the sampling distributions differ from one another. Can’t remember how to do it? Don’t make me show the picture again.</p>
<p><br></p>
<p><em><strong>Question 7.</strong></em> Formally state the null hypothesis and the alternative that you chose. Justify your choice.</p>
<p><br></p>
<p><em><strong>Question 8.</strong></em> Did you reject the null hypothesis or did you fail to reject? What was the Type-I error rate that you assumed for this test?</p>
<p><br></p>
<p><em><strong>Question 9.</strong></em> Does this make biological sense based on the description of the dataset above? Does this make biological sense based on the results of the two-sample t-test above?</p>
<p><br></p>
<p>Make a boxplot of the variable ‘max’ by lifestage only for presmolts and smolts. <strong>NOTE</strong>: it may be helpful to make a seperate dataframe that does not contain postsmolts and then transform the variable ‘stage’ to character using tools we learned in previous labs. Call the dataframe <code>smolts2</code> for ease below.</p>
<p><br></p>
<p><br></p>
</div>
<div id="chi-squared-frequency-analysis" class="section level3">
<h3>Chi-squared frequency analysis</h3>
<p>Last time we met, we conducted a chi-square frequency analysis by hand. I will not make you do that here. I will not even make you calculate it in Excel, because here we can do it in a single line of code. Hopefully this makes the programming worthwile as a tool in your modeling toolbox.</p>
<p>Create a new column in your dataframe that ranks osmolality as <code>high</code> if it is &gt;= 400 mosm, and <code>low</code> if it is &lt; 400 mosm.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Like this:</span>
  smolts2<span class="op">$</span>rank[smolts2<span class="op">$</span>osmolality<span class="op">&gt;=</span><span class="dv">400</span>] =<span class="st"> &#39;high&#39;</span>
  smolts2<span class="op">$</span>rank[smolts2<span class="op">$</span>osmolality<span class="op">&lt;</span><span class="dv">400</span>] =<span class="st"> &#39;low&#39;</span></code></pre></div>
<p><br></p>
<p>Conduct a chi-squared test to test for differences in the frequency of high and low osmolality between the presmolt and smolt stages. Use the reference script to extract the observed and expected values from the chi-squared test object.</p>
<p><br></p>
<p><em><strong>Question 10.</strong></em> Okay, no surprises that the frequency of high and low osmolality differs between these given what we already knew. Use the observed and expected tables to describe the primary differences in frequencies between these two groups in your own words.</p>
<p><br></p>
<p><br></p>
</div>
</div>
</div>

<!DOCTYPE html>
<p>Copyright &copy; 2017 Dan Stich. All rights reserved.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
