<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>hw04.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 217</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="software.html">Getting started</a>
</li>
<li>
  <a href="content.html">Course content</a>
</li>
<li>
  <a href="survival.html">Survival guide</a>
</li>
<li>
  <a href="resources.html">Additional resources</a>
</li>
<li>
  <a href="contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://danstich.github.io/worst-r/">worst-r</a>
</li>
<li>
  <a href="https://github.com/danStich">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="inferential-statistics" class="section level1">
<h1>Inferential statistics</h1>
<p><img src="../../images/peppers.jpg" alt=""></p>
<h2 id="multi">
Introduction
</h2>
<p>The objective of this assignment is to help you formalize and test some simple hypotheses using basic statistical methods in R. This week we discussed questions we can ask with null hypothesis significance testing and the strengths and weaknesses of this approach. In this assignment, we will attempt to demonstrate some of those ideas while you become familiar with performing null hypothesis significance tests in R.</p>
<p>By the end of this lab, you should be able to: 1) formally state the null hypothesis that is being tested, as well as alternatives to the null; 2) conduct some basic statistical tests of those hypotheses; and 3) communicate the results of those tests with respect to the original hypothesis.</p>
<p>We’ll work with a few packages from the tidyverse this week, so go ahead and add this to the start of your homework file</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<h3 id="multi">
The smolt data
</h3>
<p>This week we are going to work with a new dataset, called <code>smolts</code>. These data come from a lab experiment that examined differences in physiology, behavior, and survival of endangered, juvenile Atlantic salmon (<em>Salmo salar</em>) from the largest remaining population in the United States.</p>
<p>The Atlantic salmon is an anadromous (sea-run) fish that spawns in fresh water and grows in the ocean. After they hatch from their eggs in fresh water, juvenile salmon spend about 2 years growing in streams until they grow large enough to make the migration to ocean feeding grounds off the west coast of Greenland as <em>smolts</em>. During the spring before they make this migration, the fish undergoes a transformation known as ‘smolting’, which involves a complex suite of physiological, morphological, and behavioral changes. Notable among these changes is the increased ability to osmoregulate in salt water as they grow from pre-smolts to smolts. This ability is enhanced by up-regulation and increased expression of the saltwater isoform of gill Na<sup>+</sup>,K<sup>+</sup>-ATPase (NKA), an enzyme used in active transport of ions in the ocean.</p>
<p>Gill NKA activity increases seasonally from low levels early in the run (pre-smolts), to high levels in the peak of the run (smolts), and eventually decreases late in the run (post-smolts) in response to changes in daylight (photoperiod) and warming temperatures in spring. We can use gill NKA activity as an indicator of the physiological development of smolts to assess their readiness to migrate from rivers to the ocean where they will grow into adults.</p>
<p>This study compared physiological measurements of smolts throughout the course of the migratory window to their preferences for salt water or fresh water in laboratory experiments, as well as plasma osmolality (amount of salt in blood) and survival following exposure to full sea water. We used a two-chamber tank that allowed us to keep salt water in one compartment and fresh water in the other and we tracked fish behavior in the tank using high-end infrared cameras and sophisticated tracking software.</p>
<p>Let’s read in the data. We’ll use the optional argument <code>stringsAsFactors = FALSE</code> to tell R to read in all string variables as character strings (not factors) because we’ll want to get rid of one our three groups for this week.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Read in the data from comma-separated text file</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  smolts =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/smolts.txt&#39;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Look at the first few rows of data</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="kw">head</span>(smolts)</span>
<span id="cb2-6"><a href="#cb2-6"></a>  </span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Examine data structure  </span></span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="kw">str</span>(smolts)</span></code></pre></div>
<p>The dataset contains nine columns, or <code>variables</code>, defined as:</p>
<ul style="list-style-type:none;">
<li>
<code>ID</code>: This is the last five digits of a hexidecimal PIT tag code
</li>
<li>
<code>stage</code>: classification into presumed early (Presmolt), middle (Smolt), and late (Postsmolt) parts of the run
</li>
<li>
<code>fl</code>: the fork length of fish (mm)
</li>
<li>
<code>mass</code>: the mass of the fish (g)
</li>
<li>
<code>nka</code>: gill NKA activity for each fish prior to testing
</li>
<li>
<code>osmolality</code>: blood plasma osmolality following exposure to full sea water
</li>
<li>
<code>pref</code>: proportion of time spent in high salt water compartment of tank
</li>
<li>
<code>max</code>: maximum continuous time spent in high salt water compartment tank
</li>
<li>
<code>n.switch</code>: the number of times the fish moved between high salt water and low salt water compartments of the behavior tank
</li>
</ul>
<p>We will use these data to compare NKA of one group to the overall mean (one-sample tests), to compare differences in NKA and osmolality between groups (two-sample tests), and to compare the frequency of high- and low-osmolality responses between groups (frequency or contingency table analysis). We will also introduce a couple of tests for testing assumptions of normality (Shapiro-Wilk test) and for testing assumptions of equal variances (variance test) along the way.</p>
<div id="one-sample-t-tests" class="section level3">
<h3>One sample t-tests</h3>
<p>Recall that with a one-sample t-test our objective is to determine whether or not a sample that we have taken deviates from the mean of a population of interest. In this case, we require measurements of a single, continuous variable and some value to which we wish to compare those. We might be interested in this kind of question if we are trying to identify anomalous observations within a specific statistical or biological sample, or if we are trying to compare our data to literature values for which only a mean was reported (ugh!). Remember that what we are doing statistically is testing whether the population mean is contained within the 95% confidence interval (CI) for the sampling distribution of our variable of interest.</p>
<p>First, we’ll make a couple of objects out of the data in the smolts dataframe</p>
<p>Let’s make a new dataframe that includes only the stages <code>Presmolt</code> and <code>Smolt</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Make a subset of the smolts data that excludes </span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># the stage Postsmolt</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>ps &lt;-<span class="st"> </span><span class="kw">subset</span>(smolts, stage <span class="op">!=</span><span class="st"> &#39;Postsmolt&#39;</span>)</span></code></pre></div>
<p>Have a look at each of these to see how R “sees” them before we move on using <code>str()</code>, <code>head()</code>, or whatever other methods you’ve picked up. This isn’t a homework question, just a good practice that you should be getting used to now.</p>
<p>Now let’s use these data to work out a simple example. Your objective is to compare NKA activity of the stage <code>Smolt</code> to the sampling mean for gill NKA activity in the data set (<code>4.16</code>) using a one-sample t-test. You will need to choose an appropriate Type-I error rate (confidence level), and alternative hypothesis ahead of time in your analysis.</p>
<p>If you have forgotten how to do this, you can look at <a href="https://danstich.github.io/worst-r/6-1-one-sample-tests.html">Chapter 6.1</a> of The Worst Stats Text eveR, or you can type:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>?t.test</span></code></pre></div>
<p><strong>Question 1.</strong> First, formally state the null hypothesis for this test. Then, state the alternative hypothesis that you chose. If you want to use <code>greater</code> or <code>less</code> alternatives realize that this refers to the argument <code>x</code> in the <code>t.test</code> function as compared to <code>mu</code> or <code>y</code> (depending on whether it is a one or two sample test).</p>
<p>Now, run the test.</p>
<p><strong>Question 2.</strong> Does gill NKA activity of the stage <code>Smolt</code> differ significantly from the population mean? Report this <strong>in sentence format</strong> along with:</p>
<ol style="list-style-type: lower-alpha">
<li><p>The mean nka for the Smolt stage</p></li>
<li><p>The confidence interval for this mean and state the confidence level in your answer (will depend on your choice of confidence level above)</p></li>
<li><p>The t-statistic, degrees of freedom, and p-value for the test in parentheses at the very end of the sentence.</p></li>
</ol>
</div>
<div id="two-sample-t-test" class="section level3">
<h3>Two-sample t-test</h3>
<p>Now we will look at what you might think of as a more ‘standard’ application of the t-test. Here we are interested in comparing two sampling distributions from one or more biological populations to determine whether or not they come from the same statistical population. In English, we want to test whether gill NKA activities differs between presmolts and smolts.</p>
<p>For this example:</p>
<p>First, test the assumptions of normality and equal variances.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># In case you forgot the functions:</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Shapiro-Wilk normality test</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>?shapiro.test </span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Fisher&#39;s F test of equal variances</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>?var.test     </span></code></pre></div>
<p>We can also plot the distributions of gill <code>nka</code> for the <code>Presmolt</code> and <code>Smolt</code> stages to see if they look normal.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">ggplot</span>(ps, <span class="kw">aes</span>(<span class="dt">x =</span> nka, <span class="dt">fill =</span> stage)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Gill NKA Activity&quot;</span>) <span class="op">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="hw04_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><strong>Question 3.</strong> Are the sampling distributions for gill NKA activity of smolts and presmolts both <em>normal</em> based on the results of the Shapiro-Wilk test and the histogram above? Are the variances equal based on the F test?</p>
<p>Conduct a two-sample t-test to compare gill NKA activity (<code>nka</code>) between <code>Smolt</code> and <code>Presmolt</code> stages.</p>
<p><strong>Question 4.</strong> State the null hypothesis for the two-sample t-test and the alternative hypothesis that you chose. Justify your choice of alternative.</p>
<p><strong>Question 5.</strong> Did you specify the <code>var.equal</code> argument? If so, what did you choose and what was the corresponding degrees of freedom (<code>df</code>)?</p>
<p>If you did not specify this argument, note that R made a choice for you on the fly, and you can tell what that choice was by the <code>df</code> listed in the output from the test. We discussed the df for the t-test in class. In the case of the two-sample test, the df should be calculated as <span class="math inline">\((n_1-1)+(n_2-1)\)</span>, or 111 in this case, if the variances are equal. If you ran the <code>t.test</code> with this assumption the first time, go back and run it the other way and look at the <code>df</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Re-run the two-sample test</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">t.test</span>(nka <span class="op">~</span><span class="st"> </span>stage, <span class="dt">data =</span> ps)    </span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a>    Welch Two Sample t<span class="op">-</span>test</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a>data<span class="op">:</span><span class="st">  </span>nka by stage</span>
<span id="cb7-7"><a href="#cb7-7"></a>t =<span class="st"> </span><span class="fl">-7.6894</span>, df =<span class="st"> </span><span class="fl">105.22</span>, p<span class="op">-</span>value =<span class="st"> </span><span class="fl">8.247e-12</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>alternative hypothesis<span class="op">:</span><span class="st"> </span>true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="dv">95</span> percent confidence interval<span class="op">:</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="st"> </span><span class="fl">-3.025163</span> <span class="fl">-1.784862</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>sample estimates<span class="op">:</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>mean <span class="cf">in</span> group Presmolt    mean <span class="cf">in</span> group Smolt </span>
<span id="cb7-13"><a href="#cb7-13"></a>              <span class="fl">3.146038</span>               <span class="fl">5.551050</span> </span></code></pre></div>
<p>Weird, huh? How do you get a part of a degree of freedom?? And, it looks like we are short a few degrees of freedom, doesn’t it? So, what’s happening here?</p>
<p>We have to sacrifice a few extra degrees of freedom to stay conservative and avoid making a Type-I error here. What this means is that we assume our sample size is a little smaller than it really is, so estimate of the pooled variance is increased and it is more difficult to detect differences between the groups. So, we need to base the <code>df</code> on the means and variances of the two sampling distributions. Check out the calculation on this <code>definitely not wrong and totally reliable</code> <a href="https://en.wikipedia.org/wiki/Welch%27s_t_test">Wikepedia page</a>.</p>
</div>
<div id="wilcoxon-test" class="section level3">
<h3>Wilcoxon test</h3>
<p>Moving on to the next variable… (Don’t worry, we will come back to the gill NKA data next week when we talk about ANOVA, because I know you are all dying to know about the postsmolt group.)</p>
<p>Next, we will examine at differences in <code>osmolality</code> between the presmolt and smolt stages.</p>
<p><strong>Question 6.</strong> Do the sampling distributions for <code>osmolality</code> of <code>Presmolts</code> and <code>Smolts</code> conform to the normal distribution? Why or why not (there are multiple reasons).</p>
<p>If you are struggling here, plot a histogram of the distributions. Can’t remember how to do this?</p>
<p><span class="math inline">\(p(in the textbook) = 1.00\)</span></p>
<p>Okay, now that you have plotted an awesome histogram to check distributional assumptions, use a Wilcoxon test to determine whether the sampling distributions differ from one another. Can’t remember how to do it? See textbook <a href="https://danstich.github.io/worst-r/6-1-one-sample-tests.html#wilcox-test">Chapter 6.1.2</a>.</p>
<p><strong>Question 7.</strong> Formally state the null hypothesis and the alternative that you chose for the Wilcox test above. Justify your choice. (Any choice is fine - just tell me why you picked it!)</p>
<p><strong>Question 8.</strong> Did you reject the null hypothesis or did you fail to reject? What was the Type-I error rate that you assumed for this test?</p>
<p><strong>Question 9.</strong> Does the result make biological sense based on the description of the data set above? Does the result tell you the same thing as the result of the two-sample t-test above?</p>
<p>Make a boxplot of the variable <code>max</code> by <code>stage</code> to examine the maximum time spent in the full saltwater tank by <code>Presmolts</code> and <code>Smolts</code>. It can be really tough to distinguish between these two samples if you, like me, lack a crystal ball for such feats. Whatever will we do? Glad you ask!</p>
</div>
<div id="chi2-frequency-analysis" class="section level3">
<h3><span class="math inline">\(\chi^2\)</span> frequency analysis</h3>
<p>In the textbook exercises for this week, we conducted a <span class="math inline">\(\chi^2\)</span> frequency analysis and I gave you a link to show you how easy it is to do by hand. I will not make you do that here. I will not even make you calculate it in Excel, because here we can do it in a single line of code. Hopefully this makes the programming worthwhile as a tool in your modeling kit.</p>
<p>Create a new column in your dataframe that ranks osmolality as <code>high</code> if it is &gt;= 400 mosm, and <code>low</code> if it is &lt; 400 mosm.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Like this:</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>ps<span class="op">$</span>rank[ps<span class="op">$</span>osmolality <span class="op">&gt;=</span><span class="st"> </span><span class="dv">400</span>] &lt;-<span class="st"> &#39;high&#39;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>ps<span class="op">$</span>rank[ps<span class="op">$</span>osmolality <span class="op">&lt;</span><span class="st"> </span><span class="dv">400</span>] &lt;-<span class="st"> &#39;low&#39;</span></span></code></pre></div>
<p>Have a look at your data to make sure that you now have a variable called <code>rank</code> in one column that contains values of <code>high</code> and <code>low</code></p>
<p>Conduct a <span class="math inline">\(\chi^2\)</span> test to test for differences in the frequency of high and low <code>rank</code> (y) as a function of <code>stage</code> (x).</p>
<p><strong>Question 10.</strong> Do you reject or fail to reject the null in this case? What does that mean with regard to the biological question? Report the test statistic and the p-value to support this conclusion.</p>
</div>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
