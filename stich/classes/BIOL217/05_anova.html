<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>05_anova.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="..\..\styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 217</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="content.html">Course content</a>
</li>
<li>
  <a href="software.html">Software needs</a>
</li>
<li>
  <a href="resources.html">Additional Resources</a>
</li>
<li>
  <a href="contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/danStich">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="anova" class="section level1">
<h1>ANOVA</h1>
<h2 id="multi">
Worked example
</h2>
<p>The purpose of this tutorial is to give a brief, <em>coherent</em> introduction to analysis of variance (ANOVA) and give you a worked example that you can use as a template for future analyses.</p>
<div id="why-do-we-use-it" class="section level2">
<h2>Why do we use it?</h2>
<p>Last week we talked about how to compare the means of two groups to determine whether or not the sample distributions came from the same statistical population. But what do we do if we want to compare three groups?? ANOVA.</p>
<p>We use ANOVA when we would like to test the effect of one or more grouping variables on a continuous response. We generally tend to reserve ANOVA for those cases in which the grouping variable has more than two levels. To clarify, if we wished to test differences in the response between only two groups (e.g. male and female) then we would use a t-test or a Wilcoxon rank-sum test. If we wished to extend that to include three or more groups (e.g., treatment 1, treatment 2, and control) we would use an ANOVA or a non-parametric alternative.</p>
</div>
<div id="how-do-we-do-it" class="section level2">
<h2>How do we do it?</h2>
<h3 id="multi">
Syntax
</h3>
<p>In R, ANOVA and all other linear models that we will discuss this week are fit using the <code>lm</code> function. Let’s have a look:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">str</span>(lm)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="cf">function</span> (formula, data, subset, weights, na.action, <span class="dt">method =</span> <span class="st">&quot;qr&quot;</span>, <span class="dt">model =</span> <span class="ot">TRUE</span>, <span class="dt">x =</span> <span class="ot">FALSE</span>, <span class="dt">y =</span> <span class="ot">FALSE</span>, <span class="dt">qr =</span> <span class="ot">TRUE</span>, <span class="dt">singular.ok =</span> <span class="ot">TRUE</span>, <span class="dt">contrasts =</span> <span class="ot">NULL</span>, offset, ...)  </span></code></pre></div>
<p>This shows us that <code>lm</code> is a function. It takes a number of arguments, but the ones that will concern us in this course are <code>formula</code> and <code>data</code>. The <code>formula</code> argument needs to be specified as a mathematical formula, and takes the following form:</p>
<p><span class="math inline">\(y \sim x_1 + x_2, ..., + x_k\)</span></p>
<p>where <span class="math inline">\(y\)</span> is the name of our response variable, and each <span class="math inline">\(x\)</span> is the name of an explanatory variable that we wish to include in our example.</p>
<p>The <code>data</code> argument is optional, but is usually a dataframe that holds our data.</p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>Let’s walk through a quick example of what this looks like using the PlantGrowth dataset in R. We’ll just go through the steps here and explain it in the next section.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load the data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="kw">data</span>(<span class="st">&quot;PlantGrowth&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Look at the first few lines of it</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="kw">head</span>(PlantGrowth)</span>
<span id="cb2-6"><a href="#cb2-6"></a>  weight group</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="dv">1</span>   <span class="fl">4.17</span>  ctrl</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="dv">2</span>   <span class="fl">5.58</span>  ctrl</span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="dv">3</span>   <span class="fl">5.18</span>  ctrl</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="dv">4</span>   <span class="fl">6.11</span>  ctrl</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="dv">5</span>   <span class="fl">4.50</span>  ctrl</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="dv">6</span>   <span class="fl">4.61</span>  ctrl</span>
<span id="cb2-13"><a href="#cb2-13"></a>  </span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># Examine the data structure</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="kw">str</span>(PlantGrowth)</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="st">&#39;data.frame&#39;</span><span class="op">:</span><span class="st">   </span><span class="dv">30</span> obs. of  <span class="dv">2</span> variables<span class="op">:</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="st"> </span><span class="er">$</span><span class="st"> </span>weight<span class="op">:</span><span class="st"> </span>num  <span class="fl">4.17</span> <span class="fl">5.58</span> <span class="fl">5.18</span> <span class="fl">6.11</span> <span class="fl">4.5</span> <span class="fl">4.61</span> <span class="fl">5.17</span> <span class="fl">4.53</span> <span class="fl">5.33</span> <span class="fl">5.14</span> ...</span>
<span id="cb2-18"><a href="#cb2-18"></a> <span class="op">$</span><span class="st"> </span>group <span class="op">:</span><span class="st"> </span>Factor w<span class="op">/</span><span class="st"> </span><span class="dv">3</span> levels <span class="st">&quot;ctrl&quot;</span>,<span class="st">&quot;trt1&quot;</span>,..<span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> ...</span>
<span id="cb2-19"><a href="#cb2-19"></a>  </span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co"># Fit an ANOVA to the data and store it as an object</span></span>
<span id="cb2-21"><a href="#cb2-21"></a>  plant_model =<span class="st"> </span><span class="kw">lm</span>(weight<span class="op">~</span>group, <span class="dt">data=</span>PlantGrowth)</span>
<span id="cb2-22"><a href="#cb2-22"></a></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co"># Check the model diagnostics to make</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co"># sure we haven&#39;t blown any assumptions</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co"># too badly and to make sure the model</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co"># fit is reasonable before we start to</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># put any stock into the results</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb2-29"><a href="#cb2-29"></a>  <span class="kw">plot</span>(plant_model)</span></code></pre></div>
<p><img src="05_anova_files/figure-html/unnamed-chunk-3-1.png" width="576" /></p>
<p>Now print the anova table. Note that when we have grouping variables like this we need to use the <code>anova</code> function to get factor-level statistics like these:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">anova</span>(plant_model)</span>
<span id="cb3-2"><a href="#cb3-2"></a>Analysis of Variance Table</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>Response<span class="op">:</span><span class="st"> </span>weight</span>
<span id="cb3-5"><a href="#cb3-5"></a>          Df  Sum Sq Mean Sq F value  <span class="kw">Pr</span>(<span class="op">&gt;</span>F)  </span>
<span id="cb3-6"><a href="#cb3-6"></a>group      <span class="dv">2</span>  <span class="fl">3.7663</span>  <span class="fl">1.8832</span>  <span class="fl">4.8461</span> <span class="fl">0.01591</span> <span class="op">*</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>Residuals <span class="dv">27</span> <span class="fl">10.4921</span>  <span class="fl">0.3886</span>                  </span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="op">---</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span></code></pre></div>
<p>Finally, we could do multiple comparisons using a Tukey Honest Significant Difference test.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">TukeyHSD</span>(<span class="kw">aov</span>(plant_model))</span>
<span id="cb4-2"><a href="#cb4-2"></a>  Tukey multiple comparisons of means</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="dv">95</span>% family<span class="op">-</span>wise confidence level</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>Fit<span class="op">:</span><span class="st"> </span><span class="kw">aov</span>(<span class="dt">formula =</span> plant_model)</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="op">$</span>group</span>
<span id="cb4-8"><a href="#cb4-8"></a>            diff        lwr       upr     p adj</span>
<span id="cb4-9"><a href="#cb4-9"></a>trt1<span class="op">-</span>ctrl <span class="fl">-0.371</span> <span class="fl">-1.0622161</span> <span class="fl">0.3202161</span> <span class="fl">0.3908711</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>trt2<span class="op">-</span>ctrl  <span class="fl">0.494</span> <span class="fl">-0.1972161</span> <span class="fl">1.1852161</span> <span class="fl">0.1979960</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>trt2<span class="op">-</span>trt1  <span class="fl">0.865</span>  <span class="fl">0.1737839</span> <span class="fl">1.5562161</span> <span class="fl">0.0120064</span></span></code></pre></div>
<p>That’s all there is to it!</p>
</div>
</div>
<div id="what-does-it-mean" class="section level2">
<h2>What does it mean?</h2>
<p>Okay, now that we have all of this neat output, what does it all mean? Let’s go through it all step by step.</p>
<p><strong>1)</strong> The first thing we did was fit the model with the <code>lm</code> function. This not only ran the model, but it stored the model as an object in R so we could run diagnostics and summarize our results.</p>
<p><strong>2)</strong> Next, we used the <code>plot</code> function to look at some model diagnostics. The first plot showed us the residuals vs the fitted values. What we are looking for here is to make sure that there are no obvious patterns in the residuals with respect to the fitted values. Everything looks okay here for now.</p>
<p>The second plot is also very important. If all is well in the model fit, the q-q plot should look like a diagonal line with points falling more-or-less on the line. In this case, it is not perfect, but we are probably okay.</p>
<p>The third plot is a check to see if the residuals change with x (like the first) based on a square-root transform. Although we see a slight trend here, probably not anything to worry about.</p>
<p>Finally, the last plot shows the <code>leverage</code> exerted by individual points. Some points far out on the ends of the data or outliers can exert undue influence on the fit of a line. In the case of this diagnostic and the <code>Cook's D</code> we usually like to see all or a large majority of the points falling between -3 and 3 on the y-axis. So, this diagnostic checks out as well.</p>
<p><strong>3)</strong> After we actually check our assumptions and model fit, we can look at the results of the model. First, we calculate the ANOVA table for the fitted model using the aptly named <code>anova</code> function in R. This function gives us the standard ANOVA table showing sums of squares and mean squared errors for our grouping variable(s) and the model residuals (unexplained variance). The <code>anova</code> function also gives us the F-statistic for our group effects and the p-value associated with that. Note that this kind of summary is not the only way to obtain such a value. We could calculate the R-squared directly from this table as:</p>
<p><span class="math display">\[R^2 = \frac{SSB}{SSB + SSR}\]</span></p>
<p><span class="math inline">\(\\\)</span></p>
<p><span class="math display">\[R^2 = \frac{3.7663}{3.7663+10.49291}\]</span></p>
<p><span class="math inline">\(\\\)</span></p>
<p><span class="math display">\[R^2 = 0.264131\]</span></p>
<p><strong>4)</strong> That’s really all we need to report for a one-way ANOVA, but we can get some of this info from the model using <code>summary</code> as well. For instance, note that <code>summary(plant_model)</code> also returns an R-sqaured value if you forget the calculation. It is identical to ours.</p>
</div>
<div id="communicating-the-results" class="section level2">
<h2>Communicating the results</h2>
<p>Here is a quick mock-up of what this might look like in the methods and results section of a (bad) paper:</p>
<div id="methods" class="section level3">
<h3>Methods</h3>
<p><em>Data analysis</em><br />
We used one-way analysis of variance (ANOVA) to test the effects of treatment group (<code>trt1</code>, <code>trt2</code>, and <code>ctrl</code>) on the mass of plants (g). The null hypothesis for this test was that all group means were equal: <span class="math inline">\(H_0: \mu_1= \mu_2 = \mu_3\)</span>. We examined diagnostic plots to assess assumptions of normality in the residuals, verify homoscedasticity of errors, and determine the presence of influential observations in the data.</p>
<p>We determined differences between group means using a Tukey-Kramer pairwise comparison of means to control for Type-I error rates. All tests assumed a Type-I error rate of <span class="math inline">\(\alpha\)</span> = 0.05, and statistical significance was inferred at p &lt; 0.05.</p>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<p>Mass of plants varied significantly between treatment groups (ANOVA, F = 4.846, df<sub>1</sub> = 2, df<sub>2</sub> = 27, p = 0.016; Table 1). The differences between groups explained about 26% of the variation in mass (R<sup>2</sup> = 0.26). The mass of plants in the <code>trt2</code> group (5.5 <span class="math inline">\(\pm\)</span> 0.4 g) was significantly greater than plants in the <code>trt1</code> group (4.7 <span class="math inline">\(\pm\)</span> 0.8 g) in this study (Tukey HSD, p = 0.012; Fig. 1). We failed to detect differences in mass between plants in the <code>ctrl</code> group (5.0 <span class="math inline">\(\pm\)</span> 0.6 g) and <code>trt1</code> (p = 0.39) or <code>trt2</code> (p = 0.20).</p>
<p><img src="05_anova_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<details>
<p><summary>View code</summary></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>h &lt;-<span class="st"> </span><span class="kw">boxplot</span>(weight<span class="op">~</span>group,</span>
<span id="cb5-2"><a href="#cb5-2"></a>             <span class="dt">data=</span>PlantGrowth,</span>
<span id="cb5-3"><a href="#cb5-3"></a>             <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">bxp</span>(h, <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="dt">ylab=</span><span class="st">&quot;Mass (g)&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;Group&#39;</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="dt">outline=</span><span class="ot">FALSE</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="dt">pars=</span><span class="kw">list</span>(</span>
<span id="cb5-9"><a href="#cb5-9"></a>      <span class="dt">boxwex=</span><span class="fl">0.33</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>      <span class="dt">boxlwd=</span><span class="dv">2</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>      <span class="dt">boxfill=</span><span class="st">&#39;gray87&#39;</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>      <span class="dt">boxcol=</span><span class="st">&#39;gray40&#39;</span>,</span>
<span id="cb5-13"><a href="#cb5-13"></a>      <span class="dt">staplewex=</span><span class="dv">0</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>      <span class="dt">staplecol=</span><span class="st">&#39;gray40&#39;</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a>      <span class="dt">whiskcol=</span><span class="st">&#39;gray40&#39;</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>      <span class="dt">whisklwd=</span><span class="dv">2</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>      <span class="dt">whisklty=</span><span class="dv">1</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>    )</span>
<span id="cb5-19"><a href="#cb5-19"></a>    )</span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&#39;Control&#39;</span>, <span class="st">&#39;Treatment 1&#39;</span>, <span class="st">&#39;Treatment 2&#39;</span>))</span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">las=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
</div>
</div>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
