<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>hw11.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 217</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="software.html">Getting started</a>
</li>
<li>
  <a href="content.html">Course content</a>
</li>
<li>
  <a href="survival.html">Survival guide</a>
</li>
<li>
  <a href="resources.html">Additional resources</a>
</li>
<li>
  <a href="contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://danstich.github.io/worst-r/">worst-r</a>
</li>
<li>
  <a href="https://github.com/danStich">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<style>
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}

.column {
    float: left;
    padding: 15px;
}

.clearfix::after {
    content: "";
    clear: both;
    display: table;
}

.content {
    width: 75%;
}

</style>
<h1 id="multi">
Multivariate statistics
<h1>
<p><img src="../../images/iris.jpg" alt=""></p>
<h2 id="multi">
Introduction
</h2>
<p>This week we are going to tak a hard left (or right depending on which is your dominant hand) and begin to discuss methods with which we can examine <em>emergent patterns</em> in complex, messy data sets. To begin these discussions, we will take a look at the use of multivariate techniques this week. This class of analysis kind of stands on its own compared to a lot of the other methods we have discussed so far this semester. One of the biggest changes that we will see in this lab is that we are no longer working with a single response variable and one or more explanatory variables, but rather <em>many</em> response variables and one or more explanatory variables. These methods rely heavily on linear algebra, as we have discussed in class, and more broadly these and other machine-learning techniques make extensive use of distance-based measurements between observations. This week, we will try to give you a taste of what these tools can be used for. Next week, we will continue to push into some (slightly) more-advanced techniques.</p>
<p>By the end of this lab, you should 1) understand why we use multivariate analyses and how they do or do not fit in the context of what we have discussed so far, 2) be comfortable analyzing and visualizing associations with these methods, and 3) be able to interpret the results of some basic multivariate analyses.</p>
<p>We’ll be working with the <code>tidyverse</code> as always. We’ll also play with some functions from the <code>vegan</code> package that we demonstrated in the lecture tutorial, so you can go ahead and load those up now if you want to.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(vegan)</span></code></pre></div>
<div id="data-explanation" class="section level2">
<h2>Data explanation</h2>
<p>This week we will work with a data set that was collected by faculty and students at SUNY Cobleskill and was analyzed by a lake management grad student at SUNY Oneonta (who also works at SUNY Cobleskill). These data are from a study that examined the response of fish communities to herbicide treatments in Saratoga Lake, New York.</p>
<p>Let’s start by reading in the data file. This data set is not in the class data, so we will read it in straight from the raw file in one of my GitHub repositories:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Read in the data file</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  fish =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/danStich/danStich.github.io/master/stich/data/saratoga.csv&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>  </span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Have a look at the data</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="kw">str</span>(fish)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    635 obs. of  8 variables:
##  $ Name.of.Water: Factor w/ 1 level &quot;Saratoga&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Year         : int  2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...
##  $ Date         : Factor w/ 3 levels &quot;10/10/2008&quot;,&quot;10/3/2007&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Site         : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ CommonName   : Factor w/ 10 levels &quot;BBH&quot;,&quot;BC&quot;,&quot;BG&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ Species.Code : int  598 598 598 598 598 598 598 598 598 598 ...
##  $ Fish.Number  : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Total.Length : int  40 56 62 63 64 67 70 70 70 72 ...</code></pre>
<p>The brief decsription of the data is as follows:</p>
<p><code>Name.of.Water</code>: Name of the lake<br> <code>Year</code>: Year during which electrofishing survey was conducted<br> <code>Date</code>: Date of survey<br> <code>Site</code>: Site ID (1, 2, 4, 5, 6). IDK why there is no three<br> <code>CommonName</code>: Abbreviated common names for species<br> <code>Species.Code</code>: Numeric code for each species in NYSDEC fisheries database<br> <code>Fish.Number</code>: Individual fish identifier<br> <code>Total.Length</code>: Total length of fish in millimeters<br></p>
<p>Herbicides were applied to control Eurasian milfoil, an aquatic invasive plant species after in fall 2007. Fish communities were sampled prior to herbicide application in 2007, one year later in 2008, and two years later in 2009. The purpose of this study was to quantify any changes to the fish community at different sites. To do this, fish were collected from the lake at five sites using standardized electrofishing. Each fish was identified and measured.</p>
<p>Now, we want to see if we can use counts of each species as related response variables to determine any differences in fish communities before and after herbicide application.</p>
</div>
<div id="data-manipulation" class="section level2">
<h2>Data manipulation</h2>
<p>We will have to do some data manipulation before we can move on with the analysis. In order to analyze the responses of multiple species to herbicide treatments, we need to get a matrix that contains counts of each species at each <code>Site</code> in each <code>Year</code>.</p>
<p>First, we need to make a column called <code>seen</code>, which we will initialize in the <code>fish</code> data with a <code>1</code> because each of the rows in the data are individual fish.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>fish<span class="op">$</span>seen &lt;-<span class="st"> </span><span class="dv">1</span></span></code></pre></div>
<p>Next, we will group the dataframe by <code>Year</code> and <code>Site</code> and summarize <code>counts</code> as the <code>sum()</code> of the column <code>seen</code> in our <code>fish</code> dataframe. Then, we convert the dataframe from long form to wide form using the <code>pivot_wider()</code> function from <code>dplyr</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mat1 =<span class="st"> </span>fish <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">group_by</span>(Year, Site, CommonName) <span class="op">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">counts =</span> <span class="kw">sum</span>(seen)) <span class="op">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">  </span><span class="kw">pivot_wider</span>(</span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="dt">names_from =</span> CommonName,</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="dt">values_from =</span> counts)</span></code></pre></div>
<p>You can have a look at the new data format like this to see what we’ve done!</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>mat1</span></code></pre></div>
<pre><code>## # A tibble: 9 x 12
## # Groups:   Year, Site [9]
##    Year  Site   BBH    BG    CP   LMB    PS   SMB    WE    YP    BC    NP
##   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  2007     1     6    73     1    37     2     1     1     8    NA    NA
## 2  2007     2    NA    24    NA    25     1    NA    NA    12    NA    NA
## 3  2007     4     6    43    NA    28     3    NA     1    NA     1    NA
## 4  2008     2     1    14     1    11     1     1     2    24     2    NA
## 5  2008     4     2    11    NA    53     1     4     1    26    NA    NA
## 6  2008     5    NA    11     2    57     5     1     1    21    NA    NA
## 7  2009     2    NA    NA    NA    23    NA     5     2    17     1     2
## 8  2009     4    NA    NA     1    13    NA     7     2    22     3    NA
## 9  2009     6    NA    NA    NA     6    NA     1     2     2    NA    NA</code></pre>
<p>We extract the <code>Year</code> column to a new object for convenience when we run the NMDS:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#Get year out of community matrix</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>year =<span class="st"> </span>mat1<span class="op">$</span>Year</span></code></pre></div>
<p>We’ll also set aside everything but the first two columns (<code>Year</code> and <code>Site</code>) in a numeric matrix that we can feed into the <code>metaMDS()</code> function from <code>vegan</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Get the community data by themselves as</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># a numeric matrix</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>mat2 =<span class="st"> </span><span class="kw">as.matrix</span>(mat1[ ,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Have a look at the matrix</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>mat2</span></code></pre></div>
<pre><code>##       BBH BG CP LMB PS SMB WE YP BC NP
##  [1,]   6 73  1  37  2   1  1  8 NA NA
##  [2,]  NA 24 NA  25  1  NA NA 12 NA NA
##  [3,]   6 43 NA  28  3  NA  1 NA  1 NA
##  [4,]   1 14  1  11  1   1  2 24  2 NA
##  [5,]   2 11 NA  53  1   4  1 26 NA NA
##  [6,]  NA 11  2  57  5   1  1 21 NA NA
##  [7,]  NA NA NA  23 NA   5  2 17  1  2
##  [8,]  NA NA  1  13 NA   7  2 22  3 NA
##  [9,]  NA NA NA   6 NA   1  2  2 NA NA</code></pre>
<p>Next, we want to replace all of the <code>NA</code> values with zeroes, since this is what they actually are:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Replace all NA elements of matrix with</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># zeroes bc those species were not seen</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>mat2[<span class="kw">is.na</span>(mat2)] &lt;-<span class="st"> </span><span class="dv">0</span></span></code></pre></div>
<p>And, finally, we will assign <code>dimnames</code> to the matrix that are our values for <code>Site</code>. This is something we haven’t played with much. Essentially, what we are doing here is assigning a vector of names to each the rows and the columns of our matrix.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#Swap out the row and clumn numbers for names </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">dimnames</span>(mat2)=<span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;site&quot;</span>, mat1<span class="op">$</span>Site, <span class="dt">sep=</span><span class="st">&#39;&#39;</span>), </span>
<span id="cb12-3"><a href="#cb12-3"></a>                    <span class="kw">colnames</span>(mat2))</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Have one last look to make sure it worked correctly</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>mat2</span></code></pre></div>
<pre><code>##       BBH BG CP LMB PS SMB WE YP BC NP
## site1   6 73  1  37  2   1  1  8  0  0
## site2   0 24  0  25  1   0  0 12  0  0
## site4   6 43  0  28  3   0  1  0  1  0
## site2   1 14  1  11  1   1  2 24  2  0
## site4   2 11  0  53  1   4  1 26  0  0
## site5   0 11  2  57  5   1  1 21  0  0
## site2   0  0  0  23  0   5  2 17  1  2
## site4   0  0  1  13  0   7  2 22  3  0
## site6   0  0  0   6  0   1  2  2  0  0</code></pre>
</div>
<div id="community-analysis-with-nmds" class="section level2">
<h2>Community analysis with NMDS</h2>
<p>Now we can finally go ahead and analyze our data. Here, we will use the species counts, in <code>mat2</code> as our correlated response variables. Remember here that our sites and years are actually our categorical explanatory variables.</p>
<p>We have quite a few zeros in these data, so let’s use the jaccard distance calculation for our <code>distance</code> argument here just to be on the safe side. In theory, if the zeros are not actually a problem, the Jaccard distance calculations <em>should</em> return the same distance matrix as the Bray-Curtis distance calculations.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Fit the NMDS</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>fish_NMDS=<span class="kw">metaMDS</span>(</span>
<span id="cb14-3"><a href="#cb14-3"></a>  mat2, <span class="co"># Community-by-species matrix</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="dt">k=</span><span class="dv">2</span>,   <span class="co"># The number of reduced dimensions we want to use</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="dt">distance =</span> <span class="st">&quot;jaccard&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>)</span></code></pre></div>
<pre><code>## Square root transformation
## Wisconsin double standardization
## Run 0 stress 0.0562265 
## Run 1 stress 0.2077352 
## Run 2 stress 0.08453308 
## Run 3 stress 0.2077391 
## Run 4 stress 0.08690251 
## Run 5 stress 0.08691122 
## Run 6 stress 0.2077362 
## Run 7 stress 0.08646128 
## Run 8 stress 0.06418149 
## Run 9 stress 0.3209238 
## Run 10 stress 0.0845342 
## Run 11 stress 0.1715924 
## Run 12 stress 0.05622652 
## ... Procrustes: rmse 0.0001699692  max resid 0.0002578155 
## ... Similar to previous best
## Run 13 stress 0.05622683 
## ... Procrustes: rmse 0.0004049582  max resid 0.0005784915 
## ... Similar to previous best
## Run 14 stress 0.2053914 
## Run 15 stress 0.06418151 
## Run 16 stress 0.05622667 
## ... Procrustes: rmse 0.000200282  max resid 0.0003127927 
## ... Similar to previous best
## Run 17 stress 0.08453278 
## Run 18 stress 0.08453341 
## Run 19 stress 0.05622649 
## ... New best solution
## ... Procrustes: rmse 4.650777e-05  max resid 7.075048e-05 
## ... Similar to previous best
## Run 20 stress 0.08646048 
## *** Solution reached</code></pre>
<p><strong>Question 1.</strong> a) the transformation that was selected by the ordination algorithm, b) the number of runs before a solution was reached, and c) the stress at the final run. These are the kinds of things you will want to report when you do ordination.</p>
<p><strong>Question 2.</strong> What is the qualitative evaluation for your the <code>stress</code> of this ordination based upon the rules of thumb we discussed for the interpretation of stress? If you can’t remember or didn’t write it down, hit the stack[Overflow].</p>
<p>You can take a look at the fit by printing the fitted ordination to the console with the print function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Let&#39;s take a look at the summary to</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># make sure we know what is going on here</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="kw">print</span>(fish_NMDS)</span></code></pre></div>
<p>We can make a stress plot of the data to get a feel for the fit and get some sense of the fit of this model to our data. This will also give us a sense of how well the ordination captures the variability of the data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Take a look at the stress plot for the ordination</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="kw">stressplot</span>(fish_NMDS)</span></code></pre></div>
<p><strong>Question 3.</strong> How much of the variance in the data can be explained by the non-metric and linear fits for the ordination?</p>
<p>Plot the ordination of species abundances by <code>Site</code> and <code>year</code> treatment to visualize the associations:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#Ordination Plots</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co"># First, make a blank plot of the nmds</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">ordiplot</span>(fish_NMDS, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co"># Now, we can add some ellipses to show</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co"># the grouping indicated by nmds</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">ordiellipse</span>(fish_NMDS,</span>
<span id="cb18-8"><a href="#cb18-8"></a>            <span class="dt">groups=</span>year,</span>
<span id="cb18-9"><a href="#cb18-9"></a>            <span class="dt">draw=</span><span class="st">&quot;polygon&quot;</span>,</span>
<span id="cb18-10"><a href="#cb18-10"></a>            <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb18-11"><a href="#cb18-11"></a>            <span class="dt">alpha =</span> <span class="fl">0.10</span>,</span>
<span id="cb18-12"><a href="#cb18-12"></a>            <span class="dt">label =</span> <span class="ot">FALSE</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>            )</span>
<span id="cb18-14"><a href="#cb18-14"></a></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co"># Add the raw species data. Note that no</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co"># matter what the columns actually represent,</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co"># you will always use `species` for these </span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co"># plots because that is what these tools </span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co"># were originally designed for.</span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="kw">orditorp</span>(fish_NMDS,</span>
<span id="cb18-21"><a href="#cb18-21"></a>         <span class="dt">display=</span><span class="st">&quot;species&quot;</span>,</span>
<span id="cb18-22"><a href="#cb18-22"></a>         <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb18-23"><a href="#cb18-23"></a>         <span class="dt">air=</span><span class="fl">0.01</span></span>
<span id="cb18-24"><a href="#cb18-24"></a>)</span>
<span id="cb18-25"><a href="#cb18-25"></a> </span>
<span id="cb18-26"><a href="#cb18-26"></a><span class="co"># Next, add the `communities` to the plot.</span></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="co"># Same as above, these will always be called </span></span>
<span id="cb18-28"><a href="#cb18-28"></a><span class="co"># `sites` even if that isn&#39;t what your rows </span></span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="co"># represent. It is just a convention based </span></span>
<span id="cb18-30"><a href="#cb18-30"></a><span class="co"># on the purpose for which the tools were built.</span></span>
<span id="cb18-31"><a href="#cb18-31"></a><span class="kw">orditorp</span>(fish_NMDS, </span>
<span id="cb18-32"><a href="#cb18-32"></a>         <span class="dt">display=</span><span class="st">&quot;sites&quot;</span>, </span>
<span id="cb18-33"><a href="#cb18-33"></a>         <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">sort</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dv">3</span>))),</span>
<span id="cb18-34"><a href="#cb18-34"></a>         <span class="dt">air=</span><span class="fl">0.01</span>,<span class="dt">cex=</span><span class="dv">1</span></span>
<span id="cb18-35"><a href="#cb18-35"></a>)</span></code></pre></div>
<p><img src="hw11_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>The ordination suggests the following:</p>
<ol style="list-style-type: decimal">
<li><p>All of the sites appear to show some shift in the fish community between years.</p></li>
<li><p>The community appears to change from a warm-water community typified by sunfishes (BG &amp; and PS) in 2007 to a cool-water</p></li>
<li><p>Some suggestion of differences between sites in each year.</p></li>
</ol>
<p>Lastly, go ahead and test to see if there is a difference in community composition between sites and Years.</p>
<p>For this, we will use the <code>adonis()</code> function in R to to test additive effects of <code>site</code> and <code>year</code> on the species assemblage. This test is very similar to the analysis of similarities that we used earlier this week, but it has a few advantages: 1) it is more flexible because it does not rely on any distributional assumptions, making it more appropriate for NMDS, and 2) the actual function is pretty intuitive to program, requiring only a formula argument by default. We can pass our matrix to the formula as the response, and include our sites and the <code>Year</code> variable as explanatory variables.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Do a significance test to see if plants vary by turtle presence/absence</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="kw">adonis</span>(mat2<span class="op">~</span>mat1<span class="op">$</span>Site <span class="op">+</span><span class="st"> </span>mat1<span class="op">$</span>Year, <span class="dt">permutations =</span> <span class="dv">9999</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## adonis(formula = mat2 ~ mat1$Site + mat1$Year, permutations = 9999) 
## 
## Permutation: free
## Number of permutations: 9999
## 
## Terms added sequentially (first to last)
## 
##           Df SumsOfSqs MeanSqs F.Model      R2 Pr(&gt;F)   
## mat1$Site  1   0.16845 0.16845  1.7378 0.14088 0.1696   
## mat1$Year  1   0.44565 0.44565  4.5975 0.37271 0.0067 **
## Residuals  6   0.58160 0.09693         0.48641          
## Total      8   1.19570                 1.00000          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Question 4.</strong> Report the results of the adonis test in sentence format, being sure to include the test statistic and the p-values for both <code>Site</code> and <code>Year</code> in your reporting.</p>
<p><strong>Question 5.</strong> Based on the plot of the ordination, and the results of this adonis test: is species composition associated with <code>year</code> and <code>site</code>? How does this relate to the herbicide treatment conducted after the sample collected in 2007?</p>
<p><br></p>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
